<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Developer Guides | System/Hardware</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../../css/style.css" />
  <link rel="stylesheet" href="../../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="../../../api/index.html">API Reference</a></li>
<li><a href="../../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../native/index.html">Solar2D Native</a></li>
<li><a href="../../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#managing-app-transport-security-ios-macos">Managing App Transport Security — iOS &amp; macOS</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#valid-connections">Valid Connections</a></li>
<li><a href="#configuring-connections">Configuring Connections</a><ul>
<li><a href="#bypassing-ats">Bypassing ATS</a></li>
</ul></li>
<li><a href="#corona-simulator">Corona Simulator</a></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../../guide/index.html">Developer Guides</a>  ▸  <a href="../../../guide/hardware/index.html">System/Hardware</a>
</div>
<section id="managing-app-transport-security-ios-macos" class="level1">
<h1>Managing App Transport Security — iOS &amp; macOS</h1>
<p>This guide discusses Apple’s App Transport Security and how to manage it within your apps.</p>
<div class="guides-toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#valid">Valid Connections</a></li>
<li><a href="#configuring">Configuring Connections</a></li>
<li><a href="#simulator">Corona Simulator</a></li>
</ul>
</div>
<p><a id="overview"></a></p>
<section id="overview" class="level2">
<h2>Overview</h2>
<p>With each major upgrade of its operating systems, Apple introduces new features which all iOS and macOS developers must be aware of. In iOS 9 and macOS 10.11, a particularly important feature known as <strong>App Transport Security</strong> was introduced, hereafter referred to as <strong>ATS</strong>.</p>
<p>Essentially, ATS is Apple’s new guard against insecure HTTP and weaker/older HTTPS connections. Apple suggests that you adopt ATS as soon as possible, regardless of whether you’re creating a new app or updating an existing one. The intent is to protect your app’s users from exploits inherent in older Internet protocols, so the best approach is always to work with it rather than just turn it off (an option that Apple will remove in the near future anyway).</p>
<p>For comprehensive details and usage specifications for ATS, please see Apple’s <a href="https://developer.apple.com/library/prerelease/ios/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/plist/info/NSAppTransportSecurity">documentation</a>.</p>
<p><a id="prerequisites"></a></p>
</section>
<section id="prerequisites" class="level2">
<h2>Prerequisites</h2>
<p>ATS applies to both iOS and macOS apps which meet these criteria:</p>
<ul>
<li>All apps which use <a href="../../../api/library/network/index.html">high-level network-related</a> APIs (socket level APIs are not affected).</li>
<li>iOS apps built to target the iOS 9 SDK or higher.</li>
<li>macOS apps built to target macOS 10.11 or higher.</li>
</ul>
<p><a id="valid"></a></p>
</section>
<section id="valid-connections" class="level2">
<h2>Valid Connections</h2>
<p>The following conditions must be met for a connection to be allowed through ATS:</p>
<ul>
<li>HTTPS must be used to connect to the server.</li>
<li>The server must support TLS v1.2 or higher.</li>
<li>Certificates must be valid and signed using SHA256 or better. They must also use a <nobr>2048-bit</nobr> or greater RSA key or a <nobr>256-bit</nobr> or greater Elliptic Curve key. Any <nobr>up-to-date</nobr> certificate should meet these criteria.</li>
</ul>
<p><a id="configuring"></a></p>
</section>
<section id="configuring-connections" class="level2">
<h2>Configuring Connections</h2>
<div class="guide-notebox-imp">
<div class="notebox-title-imp">
Important
</div>
<p>While we provide this information for reference, Corona Labs does <strong>not</strong> encourage bypassing ATS for any connection since its intent is to protect users’ privacy.</p>
</div>
<p>ATS can be configured to manage certain specific endpoints that do not meet the <a href="#valid">valid connections</a> requirements outlined above. The following steps outline this process:</p>
<ol type="1">
<li>Configuring ATS begins with the addition of the <code>NSAppTransportSecurity</code> <nobr>key-value</nobr> pair within the <nobr><code>iphone</code> → <code>plist</code></nobr> table of your app’s <code>build.settings</code> file (<a href="../../../guide/distribution/buildSettings/index.html">guide</a>):</li>
</ol>
<div class="code-indent">
<pre class="brush: lua;">settings =
{
    iphone =
    {
        plist =
        {
            NSAppTransportSecurity =
            {

            },
        },
    },
}</pre>
</div>
<ol start="2" type="1">
<li>Inside the <code>NSAppTransportSecurity</code> table, add a <code>NSExceptionDomains</code> <nobr>key-value</nobr> pair. This allows you to specify ATS exceptions for specific domains.</li>
</ol>
<div class="code-indent">
<pre class="brush: lua;">NSAppTransportSecurity =
{
    NSExceptionDomains =
    {

    },
},</pre>
</div>
<ol start="3" type="1">
<li>Inside the <code>NSExceptionDomains</code> table, include distinct <nobr>key-value</nobr> pairs to describe <nobr>domain-specific</nobr> network connection configuration exceptions. An exception domain’s <nobr>top-level</nobr> key is the domain name string for which you want to specify a connection configuration. Because of Lua naming convention rules, you will typically need to specify these names within brackets/quotes, for instance <code>["example.com"]</code>.</li>
</ol>
<div class="code-indent">
<pre class="brush: lua;">NSAppTransportSecurity =
{
    NSExceptionDomains =
    {
        ["example.com"] =
        {

        },
    },
},</pre>
</div>
<ol start="4" type="1">
<li>Finally, to configure the exception domain, include <nobr>key-value</nobr> pairs which describe <nobr>server-specific</nobr> exceptions to your app’s overall intended network behavior. For instance:</li>
</ol>
<div class="code-indent">
<pre class="brush: lua;">NSAppTransportSecurity =
{
    NSExceptionDomains =
    {
        ["example.com"] =
        {
            NSIncludesSubdomains = true,
            NSThirdPartyExceptionAllowsInsecureHTTPLoads = true,
        },
    },
},</pre>
<p>The following table summarizes the valid options. For comprehensive details, please see Apple’s <a href="https://developer.apple.com/library/prerelease/ios/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/plist/info/NSAppTransportSecurity">documentation</a>.</p>
<div class="inner-table">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>NSIncludesSubdomains</code></td>
<td style="text-align: left;"><a href="../../../api/type/Boolean.html">boolean</a></td>
<td style="text-align: left;">An optional boolean value that, when set to <code>true</code>, applies the <code>NSExceptionDomains</code> exceptions to all subdomains of the domain whose name is the <nobr>top-level</nobr> key. Default is <code>false</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>NSExceptionAllowsInsecureHTTPLoads</code></td>
<td style="text-align: left;"><a href="../../../api/type/Boolean.html">boolean</a></td>
<td style="text-align: left;">An optional boolean value that, when set to <code>true</code>, allows insecure HTTP loads. Use this key to describe your app’s intended network behavior for a domain whose security attributes you <strong>can</strong> control. Default is <code>false</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>NSExceptionRequiresForwardSecrecy</code></td>
<td style="text-align: left;"><a href="../../../api/type/Boolean.html">boolean</a></td>
<td style="text-align: left;">An optional boolean value for overriding the requirement that a server supports forward secrecy (FS). Use this key to describe your app’s intended network behavior for a domain whose security attributes you <strong>can</strong> control. Default is <code>true</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>NSExceptionMinimumTLSVersion</code></td>
<td style="text-align: left;"><a href="../../../api/type/String.html">string</a></td>
<td style="text-align: left;">An optional string value that specifies the minimum Transport Layer Security (TLS) version for connections. Use this key to describe your app’s intended network behavior for a domain whose security attributes you <strong>can</strong> control. Default value is <code>TLSv1.2</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>NSThirdPartyExceptionAllowsInsecureHTTPLoads</code></td>
<td style="text-align: left;"><a href="../../../api/type/Boolean.html">boolean</a></td>
<td style="text-align: left;">A version of the <code>NSExceptionAllowsInsecureHTTPLoads</code> key to be used to configure connections for a domain whose security attributes you <strong>cannot</strong> control.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>NSThirdPartyExceptionRequiresForwardSecrecy</code></td>
<td style="text-align: left;"><a href="../../../api/type/Boolean.html">boolean</a></td>
<td style="text-align: left;">A version of the <code>NSExceptionRequiresForwardSecrecy</code> key to be used to configure connections for a domain whose security attributes you <strong>cannot</strong> control.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>NSThirdPartyExceptionMinimumTLSVersion</code></td>
<td style="text-align: left;"><a href="../../../api/type/String.html">string</a></td>
<td style="text-align: left;">A version of the <code>NSExceptionMinimumTLSVersion</code> key to be used to configure connections for a domain whose security attributes you <strong>cannot</strong> control.</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol start="5" type="1">
<li>Putting it together, an example ATS configuration block within <code>build.settings</code> may be structured like this:</li>
</ol>
<div class="code-indent">
<pre class="brush: lua;">settings =
{
    iphone =
    {
        plist =
        {
            NSAppTransportSecurity =
            {
                NSExceptionDomains =
                {
                    ["example.com"] =
                    {
                        NSIncludesSubdomains = true,
                        NSThirdPartyExceptionAllowsInsecureHTTPLoads = true,
                    },
                },
            },
        },
    },
}</pre>
</div>
<section id="bypassing-ats" class="level3">
<h3>Bypassing ATS</h3>
<p>As a last resort, ATS can also be configured to <strong>allow</strong> insecure connections by default. This can be accomplished by including the <code>NSAllowsArbitraryLoads</code> key within the <code>NSAppTransportSecurity</code> table and setting its value to <code>true</code>:</p>
<pre class="brush: lua;">NSAppTransportSecurity =
{
    NSAllowsArbitraryLoads = true,
},</pre>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<p>If you globally bypass ATS in this manner, exception domains can still be defined as outlined above. In this case, you can effectively <strong>increase</strong> restrictions on a specific server. For example, setting the value of a named server’s <code>NSExceptionAllowsInsecureHTTPLoads</code> key to <code>false</code> <nobr>re-enables</nobr> HTTPS enforcement for that server.</p>
</div>
<p><a id="simulator"></a></p>
</section>
</section>
<section id="corona-simulator" class="level2">
<h2>Corona Simulator</h2>
<p>Since the Corona Simulator on macOS must simulate all types of devices, including those that do not implement ATS, it turns it off for all connections.</p>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
