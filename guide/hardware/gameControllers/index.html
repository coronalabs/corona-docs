<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Developer Guides | System/Hardware</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../../css/style.css" />
  <link rel="stylesheet" href="../../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="../../../api/index.html">API Reference</a></li>
<li><a href="../../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../native/index.html">Solar2D Native</a></li>
<li><a href="../../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#game-controllers">Game Controllers</a><ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#querying-devices">Querying Devices</a></li>
<li><a href="#connectingdisconnecting-controllers">Connecting/Disconnecting Controllers</a></li>
<li><a href="#handling-controller-input">Handling Controller Input</a><ul>
<li><a href="#handling-keys">Handling Keys</a></li>
<li><a href="#handling-axes">Handling Axes</a></li>
</ul></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#references">References</a><ul>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#third-party-drivers">Third-Party Drivers</a></li>
<li><a href="#sample-code">Sample Code</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../../guide/index.html">Developer Guides</a>  ▸  <a href="../../../guide/hardware/index.html">System/Hardware</a>
</div>
<section id="game-controllers" class="level1">
<h1>Game Controllers</h1>
<p>In Corona, creating apps with gamepad/joystick support is both easy and interactive. This guide outlines how the game controller APIs and events work together.</p>
<div class="guides-toc">
<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#querying">Querying Devices</a></li>
<li><a href="#connections">Connecting/Disconnecting Controllers</a></li>
<li><a href="#input">Handling Controller Input</a></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>
<p><a id="requirements"></a></p>
<section id="requirements" class="level2">
<h2>Requirements</h2>
<ul>
<li><p>Game controllers are supported in the Corona Simulator for macOS or Windows, in Win32 desktop apps, and on Android devices.</p></li>
<li><p>Supported game controller(s). The Corona Simulator for macOS supports most game controllers, but some controllers require additional setup. Tested controllers include:</p>
<ul>
<li>Xbox 360 Controller (wired or wireless with PC receiver). This controller requires a <a href="https://github.com/d235j/360Controller/releases">360Controller driver</a>.</li>
<li>Xbox One Controller. This controller requires the <a href="https://github.com/FranticRain/Xone-OSX/releases/latest">Xone-OSX driver</a>.</li>
<li>DualShock 4/3/2/1 (PlayStation controllers). These controllers work out of the box, however their key bindings will vary.</li>
<li>Various Logitech/generic PC game controllers which all tested without issues. However, key bindings vary widely from device to device.</li>
</ul></li>
<li><p>This guide accompanies the “Pew Pew!” sample app which utilizes all game controller APIs. You may download it from our <a href="https://github.com/coronalabs/PewPew">GitHub repository</a>.</p></li>
</ul>
<p><a id="querying"></a></p>
</section>
<section id="querying-devices" class="level2">
<h2>Querying Devices</h2>
<p>The initial API to begin with is <a href="../../../api/library/system/getInputDevices.html">system.getInputDevices()</a> which returns a list of all detected input devices. Note, however, the following differences between platforms:</p>
<ul>
<li>On Android, this call returns all connected input devices, including touch screens, gamepads, keyboards, etc.</li>
<li>On macOS, this call will return only joysticks/gamepads.</li>
<li>On Windows, this call returns all DirectInput and XInput devices.</li>
</ul>
<p>Essentially, when an application starts, you can check if key bindings for a device are stored:</p>
<pre class="brush: lua;">local inputDevices = system.getInputDevices()

for i = 1,#inputDevices do
    local device = inputDevices[i]
    print( device.descriptor )
end</pre>
<p>Effectively, each entry in the list returned by <a href="../../../api/library/system/getInputDevices.html">system.getInputDevices()</a> is an instance of <a href="../../../api/type/InputDevice/index.html">InputDevice</a>. You can query this for information about the device, for example:</p>
<ul>
<li><p>The <a href="../../../api/type/InputDevice/descriptor.html">object.descriptor</a> property indicates the controller identifier during a session/run. If the same device is disconnected and later reconnected, it will have same <code>descriptor</code> value, however this doesn’t mean that <code>descriptor</code> will remain unchanged between sessions/runs. In a subsequent session/run, controllers are liable to have different <code>descriptor</code> values.</p></li>
<li><p>The <a href="../../../api/type/InputDevice/displayName.html">object.displayName</a> of the device is reported by the operating system. You can display this so the user can identify which controller is being used.</p></li>
<li><p>You may also query the <a href="../../../api/type/InputDevice/index.html">InputDevice</a> object for its axes via the <a href="../../../api/type/InputDevice/getAxes.html">object:getAxes()</a> method or cause it to vibrate with the <a href="../../../api/type/InputDevice/vibrate.html">object:vibrate()</a> function. Please see the <a href="../../../api/type/InputDevice/index.html">documentation</a> for a complete list of properties and methods.</p></li>
</ul>
<p><a id="connections"></a></p>
</section>
<section id="connectingdisconnecting-controllers" class="level2">
<h2>Connecting/Disconnecting Controllers</h2>
<p>The <a href="../../../api/event/inputDeviceStatus/index.html">inputDeviceStatus</a> event is fired whenever a controller is connected or disconnected. The following example shows how to handle this event:</p>
<pre class="brush: lua;">local function onInputDeviceStatusChanged( event )
    
    if ( event.connectionStateChanged ) then
        if ( event.device.isConnected ) then
            -- Device has been connected
        else
            -- Connection has been lost
        end
    end
end

Runtime:addEventListener( "inputDeviceStatus", onInputDeviceStatusChanged )</pre>
<p>Within the listener function, the <code>event</code> table contains the following properties pertaining to the device which received a status change:</p>
<ul>
<li><a href="../../../api/event/inputDeviceStatus/connectionStateChanged.html">event.connectionStateChanged</a> — <a href="../../../api/type/Boolean.html">Boolean</a> value indicating if the device’s connection with the system has changed.</li>
<li><a href="../../../api/event/inputDeviceStatus/device.html">event.device</a> — Returns an <a href="../../../api/type/InputDevice/index.html">InputDevice</a> object with various properties.</li>
<li><a href="../../../api/event/inputDeviceStatus/name.html">event.name</a> — <a href="../../../api/type/String.html">String</a> value of <code>"inputDeviceStatus"</code>.</li>
<li><a href="../../../api/event/inputDeviceStatus/reconfigured.html">event.reconfigured</a> — <a href="../../../api/type/Boolean.html">Boolean</a> value indicating if the device has been reconfigured.</li>
</ul>
<p><a id="input"></a></p>
</section>
<section id="handling-controller-input" class="level2">
<h2>Handling Controller Input</h2>
<p>Game controllers produce two types of events as a result of input: <a href="../../../api/event/axis/index.html">axis</a> and <a href="../../../api/event/key/index.html">key</a>.</p>
<p>A <a href="../../../api/event/key/index.html">key</a> event’s <code>event.device</code> property will be <code>nil</code> on both macOS and Windows. It can also be <code>nil</code> on Android if it came from a virtual input device such as the virtual keyboard.</p>
<p>The following example shows how to detect a specific controller. When either an <code>axis</code> or <code>key</code> event is triggered, the <code>setDevice()</code> function is called which sets the <code>event.device</code> and <a href="../../../api/type/InputDevice/index.html">InputDevice</a> <code>displayName</code>.</p>
<pre class="brush: lua;">local controller = { device="", displayName="" }

--Predeclare
local onKeyEvent
local onAxisEvent

local function setDevice( device, displayName )

    -- Set current controller
    controller["device"] = device
    controller["displayName"] = displayName

    -- Remove event listeners
    Runtime:removeEventListener( "axis", onAxisEvent )
    Runtime:removeEventListener( "key", onKeyEvent )
end

function onKeyEvent( event )
    setDevice( event.device, event.device.displayName )
end

function onAxisEvent( event )
    if ( math.abs(event.normalizedValue) > 0.5 ) then
        setDevice( event.device, event.device.displayName )
    end
end

Runtime:addEventListener( "axis", onAxisEvent )
Runtime:addEventListener( "key", onKeyEvent )</pre>
<div class="guide-notebox">
<div class="notebox-title">
Notes
</div>
<ul>
<li><p>In the above example, <code>event.normalizedValue</code> for the <code>onAxisEvent()</code> listener function is compared to <code>0.5</code>. This means that the axis is turned by a “readable” amount, or more than halfway through.</p></li>
<li><p>Some game controllers produce both <code>axis</code> and <code>key</code> events when analog triggers are pressed, so you may wish to conditionally handle this possibility.</p></li>
</ul>
</div>
<section id="handling-keys" class="level3">
<h3>Handling Keys</h3>
<p>Keys are handled with <a href="../../../api/event/key/index.html">key</a> events. Whenever the user presses a button on a gamepad/joystick or a key on the keyboard, this event is triggered. To identify which button/key was pressed, refer to the <a href="../../../api/event/key/keyName.html">event.keyName</a> documentation. Furthermore, when a <code>key</code> event occurs, <code>event.phase</code> will equal <code>"down"</code> when the button/key is pressed down, or <code>"up"</code> when the button/key is released.</p>
</section>
<section id="handling-axes" class="level3">
<h3>Handling Axes</h3>
<p>The <a href="../../../api/event/axis/index.html">axis</a> event fires any time the controller’s axis values change. This can result in a large amount of events, so game developers should consider accumulating the axis state. Each event has several useful properties:</p>
<ul>
<li><a href="../../../api/event/axis/device.html">event.device</a> — Refers to the <a href="../../../api/type/InputDevice/index.html">InputDevice</a> which this axis belongs to.</li>
<li><a href="../../../api/event/axis/axis.html">event.axis</a> — Refers to the <a href="../../../api/type/InputAxis/index.html">InputAxis</a> object of the axis which produced the event.</li>
<li><a href="../../../api/event/axis/normalizedValue.html">event.normalizedValue</a> — Contains the value of the axis in the range of -1.0 to 1.0.</li>
<li><a href="../../../api/event/axis/rawValue.html">event.rawValue</a> — Contains the value reported by the hardware; this should be interpreted according to values in the <code>axis</code> field.</li>
</ul>
<div class="guide-notebox-imp">
<div class="notebox-title-imp">
Important
</div>
<ul>
<li><p>The usual workflow when dealing with <code>axis</code> events is to accumulate values. In this approach, <a href="../../../api/event/axis/normalizedValue.html">event.normalizedValue</a> is typically most useful.</p></li>
<li><p>Like devices, an axis can provide useful information about itself. <a href="../../../api/type/InputAxis/index.html">InputAxis</a> tables are returned by <a href="../../../api/type/InputDevice/getAxes.html">object:getAxes()</a> and <a href="../../../api/event/axis/axis.html">axis</a> in <code>axis</code> events. Probably the most useful property is <a href="../../../api/type/InputAxis/type.html">type</a> which attempts to describe the utility of the axis.</p></li>
</ul>
</div>
<p><a id="summary"></a></p>
</section>
</section>
<section id="summary" class="level2">
<h2>Summary</h2>
<ul>
<li><p>Game controllers are supported in the Corona Simulator for macOS or Windows, in Win32 desktop apps, and on Android devices.</p></li>
<li><p>Game controller support can be implemented using the following events:</p>
<ul>
<li>The <a href="../../../api/event/axis/index.html">axis</a> event fires every time a game controller axis changes position, and <a href="../../../api/event/axis/normalizedValue.html">event.normalizedValue</a> should typically be used to access its position.</li>
<li>The <a href="../../../api/event/key/index.html">key</a> event reports both the <a href="../../../api/event/key/keyName.html">event.keyName</a> and <code>event.phase</code> of <code>"down"</code> or <code>"up"</code> for each button/key press.</li>
<li>The <a href="../../../api/event/inputDeviceStatus/index.html">inputDeviceStatus</a> event fires every time a device is connected, disconnected, or reconfigured.</li>
</ul></li>
<li>All three events above reference the <a href="../../../api/type/InputDevice/index.html">InputDevice</a> which produced the event, accessible via <code>event.device</code>.
<ul>
<li>If the device is the system keyboard, <code>event.device</code> may be <code>nil</code>.</li>
<li>Use <a href="../../../api/type/InputDevice/descriptor.html">object.descriptor</a> to identify devices within a session and <a href="../../../api/type/InputDevice/displayName.html">object.displayName</a> to get a readable device name reported by the operating system.</li>
</ul></li>
<li><p>To list known game controllers, use the <a href="../../../api/library/system/getInputDevices.html">system.getInputDevices()</a> function.</p></li>
<li><p>It’s wise to accumulate axis changes and take action later, for instance in the runtime <code>"enterFrame"</code> listener, similar to the <a href="https://github.com/coronalabs/PewPew">sample app</a> method.</p></li>
</ul>
<p><a id="references"></a></p>
</section>
<section id="references" class="level2">
<h2>References</h2>
<section id="documentation" class="level3">
<h3>Documentation</h3>
<ul>
<li><a href="../../../api/type/InputDevice/index.html">InputDevice</a> type</li>
<li><a href="../../../api/type/InputAxis/index.html">InputAxis</a> type</li>
<li><a href="../../../api/event/inputDeviceStatus/index.html">inputDeviceStatus</a> event</li>
<li><a href="../../../api/event/key/index.html">key</a> event</li>
<li><a href="../../../api/event/axis/index.html">axis</a> event</li>
<li><a href="../../../api/library/system/getInputDevices.html">system.getInputDevices()</a></li>
</ul>
</section>
<section id="third-party-drivers" class="level3">
<h3>Third-Party Drivers</h3>
<ul>
<li><a href="https://github.com/d235j/360Controller/releases">360Controller driver</a></li>
<li><a href="https://github.com/FranticRain/Xone-OSX/releases/latest">Xone-OSX driver</a></li>
</ul>
</section>
<section id="sample-code" class="level3">
<h3>Sample Code</h3>
<ul>
<li><a href="https://github.com/coronalabs/PewPew">Pew Pew!</a> sample app</li>
<li><a href="https://github.com/coronalabs/samples-coronasdk/tree/master/Hardware/InputDevices">InputDevices</a> sample app</li>
</ul>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
