<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Developer Guides | Graphics/Audio/Animation</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../../css/style.css" />
  <link rel="stylesheet" href="../../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="../../../api/index.html">API Reference</a></li>
<li><a href="../../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../native/index.html">Solar2D Native</a></li>
<li><a href="../../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#masking-images">Masking Images</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#creating-mask-images">Creating Mask Images</a></li>
<li><a href="#applying-masks">Applying Masks</a></li>
<li><a href="#mask-manipulation">Mask Manipulation</a></li>
<li><a href="#group-masking">Group Masking</a></li>
<li><a href="#hit-masking">Hit Masking</a></li>
<li><a href="#dynamic-mask-selection">Dynamic Mask Selection</a></li>
<li><a href="#removing-masks">Removing Masks</a></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../../guide/index.html">Developer Guides</a>  ▸  <a href="../../../guide/media/index.html">Graphics/Audio/Animation</a>
</div>
<section id="masking-images" class="level1">
<h1>Masking Images</h1>
<p>This guide discusses how to use <a href="../../../api/library/graphics/newMask.html">graphics.newMask()</a> to mask individual display objects or entire display groups.</p>
<div class="guides-toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#create">Creating Mask Images</a></li>
<li><a href="#apply">Applying Masks</a></li>
<li><a href="#manipulate">Mask Manipulation</a></li>
<li><a href="#groupmask">Group Masking</a></li>
<li><a href="#hitmasking">Hit Masking</a></li>
<li><a href="#dynamic">Dynamic Mask Selection</a></li>
<li><a href="#remove">Removing Masks</a></li>
</ul>
</div>
<p><a id="overview"></a></p>
<section id="overview" class="level2">
<h2>Overview</h2>
<p>Masking is a common practice in digital design. Using a black and white (or grayscale) image mask, you can show/hide portions of a <a href="../../../guide/media/displayObjects/index.html">display object</a> or <a href="../../../guide/graphics/group.html">display group</a> according to the mask composition. For example, you may create a mask image with white portions and black portions. When applied to a target object/group, the black portions of the mask will render the underlying pixels fully transparent (this is represented by the gray checkerboard in the following examples). In contrast, pixels behind the white portion of the mask image will remain fully visible.</p>
<div class="float-right" style="float: none; margin: 20px 0px 20px 0px; font-size: 125%; color: #292929; vertical-align: middle;">
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-base1.png" /></td>
<td style="text-align: center;"> + </td>
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-mask1.png" /></td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-result1.png" /></td>
</tr>
</tbody>
</table>
</div>
<p>Mask images can also be created with gray regions or gradients. In this case, a region of 80% gray will render pixels in the underlying object/group at 20% opacity. Similarly, a region of 10% gray will render the underlying pixels at 90% opacity.</p>
<div class="float-right" style="float: none; margin: 20px 0px 20px 0px; font-size: 125%; color: #292929; vertical-align: middle;">
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-base1.png" /></td>
<td style="text-align: center;"> + </td>
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-mask2.png" /></td>
<td style="text-align: center;"> = </td>
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-result2.png" /></td>
</tr>
</tbody>
</table>
</div>
<p><a id="create"></a></p>
</section>
<section id="creating-mask-images" class="level2">
<h2>Creating Mask Images</h2>
<p>Mask image files can be created using any standard image editing program like <a href="https://www.adobe.com/products/photoshop.html">Photoshop</a>®, <a href="https://www.gimp.org/downloads/">GIMP</a>, or <a href="https://www.getpaint.net/download.html">Paint.NET</a>. When creating the image, you <strong>must</strong> obey the following rules to ensure that masks behave properly.</p>
<div class="guide-notebox-imp">
<div class="notebox-title-imp title-nomargin">
Mask Image Requirements
</div>
<ul>
<li><p>The mask image must have width and height dimensions that are <strong>divisible by 4</strong>.</p></li>
<li><p>The mask image must be bordered by at least <strong>3 pixels</strong> of black space on all four sides. You may need to increase the overall size of your mask image to include this border.</p></li>
<li><p>If the mask image is smaller than the target image, the region outside of the mask bounds will be fully masked (transparent).</p></li>
</ul>
</div>
<p><a id="apply"></a></p>
</section>
<section id="applying-masks" class="level2">
<h2>Applying Masks</h2>
<p>With the mask file properly prepared and saved, the next step is to create an actual mask using the <a href="../../../api/library/graphics/newMask.html">graphics.newMask()</a> API. Just supply the name of the mask image file to the function as follows:</p>
<pre class="brush: lua;">local mask = graphics.newMask( "maskframe.png" )</pre>
<p>Next, apply the mask to an object of your choice using the <code>setMask()</code> function:</p>
<pre class="brush: lua;">local mountains = display.newImageRect( "mountains.png", 280, 216 )
mountains.x, mountains.y = 200,160

mountains:setMask( mask )</pre>
<div class="float-right" style="float: none; margin: 20px 0px 20px 0px; font-size: 125%; color: #292929; vertical-align: middle;">
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-base1.png" /></td>
<td> → </td>
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-result1.png" /></td>
</tr>
</tbody>
</table>
</div>
<p>As illustrated, the area of the photo masked by black is invisible while the white area remains fully visible. The photo and mask can now be regarded as a single display object and, like any normal display object, it can be moved, rotated, inserted into a display group, etc.</p>
<p>Note that the width and height of the masked object remain the same as the unmasked version, even though the example photo appears smaller because of the mask. Solar2D respects the original dimensions in regards to size and positioning. However, touch/tap detection is ignored on completely masked (invisible) regions of an object unless you declare otherwise — see <a href="#hitmasking">Hit Masking</a> below for more information.</p>
<div class="guide-notebox-imp">
<div class="notebox-title-imp">
Important
</div>
<p>Currently, mask images are not dynamically selected based on the device resolution, unlike images that are displayed using <a href="../../../api/library/display/newImageRect.html">display.newImageRect()</a>. Thus, if your masks are very detailed and you need to choose a mask image of the proper resolution for different devices, you should check <a href="../../../api/library/display/imageSuffix.html">display.imageSuffix</a> and use the appropriate mask image based on its value. See the example in <a href="../../../api/library/graphics/newMask.html">graphics.newMask()</a> for more details.</p>
</div>
<p><a id="manipulate"></a></p>
</section>
<section id="mask-manipulation" class="level2">
<h2>Mask Manipulation</h2>
<p>Masks are always applied to an object’s default anchor point at an angle of 0 with a scale ratio of 1:1. However, you can manipulate the mask after you’ve set it, in instances where you need to rotate/scale it or change its position relative to the image/group.</p>
<p>The following properties are available for mask manipulation:</p>
<div class="inner-table">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/type/DisplayObject/maskX.html">object.maskX</a></td>
<td style="text-align: left;">Sets or retrieves the <strong>x</strong> position of the mask.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="../../../api/type/DisplayObject/maskY.html">object.maskY</a></td>
<td style="text-align: left;">Sets or retrieves the <strong>y</strong> position of the mask.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/type/DisplayObject/maskRotation.html">object.maskRotation</a></td>
<td style="text-align: left;">Sets or retrieves the rotation angle of the mask.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="../../../api/type/DisplayObject/maskScaleX.html">object.maskScaleX</a></td>
<td style="text-align: left;">Sets or retrieves the <strong>x</strong> scale factor of the mask.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/type/DisplayObject/maskScaleY.html">object.maskScaleY</a></td>
<td style="text-align: left;">Sets or retrieves the <strong>y</strong> scale factor of the mask.</td>
</tr>
</tbody>
</table>
</div>
<p>This example sets the mask, shifts its <strong>x</strong> position 10 pixels to the left, rotates it 20 degrees, and scales it down to 80% its normal size:</p>
<pre class="brush: lua;">local mask = graphics.newMask( "maskframe.png" )

local mountains = display.newImageRect( "mountains.png", 280, 216 )
mountains.x, mountains.y = 200,160

mountains:setMask( mask )

mountains.maskX = -10
mountains.maskRotation = 20
mountains.maskScaleX = 0.8
mountains.maskScaleY = 0.8</pre>
<div class="float-right" style="float: none; margin: 20px 0px 20px 0px; font-size: 125%; color: #292929; vertical-align: middle;">
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-result1.png" /></td>
<td> → </td>
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-result3.png" /></td>
</tr>
</tbody>
</table>
</div>
<p><a id="groupmask"></a></p>
</section>
<section id="group-masking" class="level2">
<h2>Group Masking</h2>
<p>As indicated already, masks can be applied to <a href="../../../guide/graphics/group.html">display groups</a> as well as individual display objects.</p>
<pre class="brush: lua;">local group = display.newGroup()

local mask = graphics.newMask( "maskframe.png" )

group:setMask( mask )

group.maskX = group.x
group.maskY = group.y</pre>
<p><a id="hitmasking"></a></p>
</section>
<section id="hit-masking" class="level2">
<h2>Hit Masking</h2>
<p>Masking can also be used to prevent touch/tap response over completely masked (invisible) regions of an object. This is not possible with a standard, unmasked display object surrounded by transparent pixels. In that case, the object will appear smaller than its canvas size, but the system will still recognize user input on the transparent region. Thus, when dealing with very precise touch/tap recognition, the solution is to mask the image, using 100% black to mask the areas which should <strong>not</strong> return a touch or tap response.</p>
<p>In the normal, unmasked image below, the system will report input response over the entire canvas, including the transparent pixels represented by gray checkerboard. However, if you need to constrain user input to only the <strong>visible</strong> portion (the icon itself), a mask is the best solution. In the masked example shown here, touch/tap response will be ignored outside of the visible region.</p>
<div class="float-right" style="float: none; margin: 20px 0px 20px 0px; font-size: 125%; color: #292929; vertical-align: middle;">
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-base2.png" /></td>
<td style="text-align: left;"> + </td>
<td style="text-align: left;"><img src="../../../images/simulator/image-mask-mask3.png" /></td>
</tr>
</tbody>
</table>
</div>
<p>If you need to override this behavior, but still require masking on the object, you can instruct the system to recognize user input on <strong>all</strong> areas of the masked object by setting the <code>object.isHitTestMasked</code> property to <code>false</code>:</p>
<pre class="brush: lua;">object.isHitTestMasked = false</pre>
<p><a id="dynamic"></a></p>
</section>
<section id="dynamic-mask-selection" class="level2">
<h2>Dynamic Mask Selection</h2>
<p>Unlike images and image sheets, Solar2D does not automatically load different mask files based on the screen resolution. The standard behavior of masks is to scale along with the content area. This makes basic mask usage very simple: provide one mask image file and it will scale according to the object on which it’s placed.</p>
<p>However, an accurate, sharp mask image is sometimes required and <nobr>auto-scaling</nobr> is not ideal in such cases. One solution is to retrieve the internal image suffix using <a href="../../../api/library/display/imageSuffix.html">display.imageSuffix</a> and append it to the file parameter when creating the mask. Please see the example in <a href="../../../api/library/graphics/newMask.html">graphics.newMask()</a> for details.</p>
<p><a id="remove"></a></p>
</section>
<section id="removing-masks" class="level2">
<h2>Removing Masks</h2>
<p>To remove a mask from an object, simply call <code>object:setMask( nil )</code>. Remember to also <code>nil</code> the handle of the mask if it won’t be used again.</p>
<pre class="brush: lua;">mountains:setMask( nil )
mask = nil</pre>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
