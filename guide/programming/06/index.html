<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Developer Guides | Getting Started</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../../css/style.css" />
  <link rel="stylesheet" href="../../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="../../../api/index.html">API Reference</a></li>
<li><a href="../../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../native/index.html">Solar2D Native</a></li>
<li><a href="../../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#chapter-6-implementing-high-scores">Chapter 6 — Implementing High Scores</a><ul>
<li><a href="#composer-accessible-data">Composer-Accessible Data</a></li>
<li><a href="#high-scores-scene">High Scores Scene</a></li>
<li><a href="#loading-data">Loading Data</a></li>
<li><a href="#saving-data">Saving Data</a></li>
<li><a href="#displaying-high-scores">Displaying High Scores</a></li>
<li><a href="#leaving-the-scene">Leaving the Scene</a></li>
<li><a href="#scene-cleanup">Scene Cleanup</a></li>
<li><a href="#chapter-concepts">Chapter Concepts</a></li>
<li><a href="#section"></a></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../../guide/index.html">Developer Guides</a>  ▸  <a href="../../../guide/programming/index.html">Getting Started</a>
</div>
<section id="chapter-6-implementing-high-scores" class="level1">
<h1>Chapter 6 — Implementing High Scores</h1>
<div class="walkthrough-nav">
<div class="walkthrough-nav-upper-right">
<p><strong>⟨</strong> <a href="../../../guide/programming/05/index.html">Previous</a> <em>|</em> <a href="../../../guide/programming/07/index.html">Next</a> <strong>⟩</strong></p>
</div>
</div>
<p>In this chapter, we’ll create a scene to display the ten highest scores for the game. We’ll also explore how to save these scores to a persistent location.</p>
<div class="guides-toc">
<ul>
<li><a href="#accessibledata">Composer-Accessible Data</a></li>
<li><a href="#highscores">High Scores Scene</a></li>
<li><a href="#loaddata">Loading Data</a></li>
<li><a href="#savedata">Saving Data</a></li>
<li><a href="#displayscores">Displaying High Scores</a></li>
<li><a href="#leavescene">Leaving the Scene</a></li>
<li><a href="#cleanup">Scene Cleanup</a></li>
<li><a href="#concepts">Chapter Concepts</a></li>
</ul>
</div>
<p><a id="accessibledata"></a></p>
<section id="composer-accessible-data" class="level2">
<h2>Composer-Accessible Data</h2>
<p>For the most part, when you use Composer, scenes remain <nobr>self-contained</nobr>, meaning that variables, functions, and objects which you create within a given scene are isolated to that specific scene. For example, the <code>lives</code> and <code>score</code> variables that we use within <code>game.lua</code> are associated only with that scene.</p>
<p>This is generally good for keeping an app clean and organized, but sometimes you’ll need to access variables/objects in one scene from a different scene that’s inherently unaware of their existence. In this chapter, for instance, we’ll need to access the player’s score <nobr>(<code>score</code> from <code>game.lua</code>)</nobr> inside our new <code>highscores.lua</code> scene.</p>
<p>Lua itself provides various ways to pass and access data between modules, but Composer makes it even easier with the following commands:</p>
<ul>
<li><code>composer.setVariable()</code> — Sets a variable declared in one scene to be accessible throughout the entire <nobr>Composer-structured</nobr> app.</li>
<li><code>composer.getVariable()</code> — Allows you to retrieve the value of any variable previously set via <code>composer.setVariable()</code>.</li>
</ul>
<p>Armed with these commands, let’s update the <code>endGame()</code> function:</p>
<ol type="1">
<li><p>Open your <code>game.lua</code> file.</p></li>
<li><p>Locate the <code>endGame()</code> function and <strong>replace</strong> its contents with the following two commands:</p></li>
</ol>
<div class="code-indent">
<pre class="highlight: [186,187]; first-line: 185; gutter: true; brush: lua;">local function endGame()
    composer.setVariable( "finalScore", score )
    composer.gotoScene( "highscores", { time=800, effect="crossFade" } )
end</pre>
<p>The first new command, <nobr><code>composer.setVariable( "finalScore", score )</code></nobr>, creates a <nobr>Composer-accessible</nobr> variable named <code>finalScore</code> with an assigned value of the <code>score</code> variable. With this in place, we’ll be able to retrieve the value from the high scores scene.</p>
<p>The second command simply redirects the app to the <code>highscores.lua</code> scene instead of the menu scene.</p>
</div>
<ol start="3" type="1">
<li>Save your modified <code>game.lua</code> file.</li>
</ol>
<div class="docs-tip-outer">
<div class="docs-tip-inner-left">
<div class="fa fa-cog">

</div>
</div>
<div class="docs-tip-inner-right">
<p>You can pass any standard Lua variable type, including tables, as the value for <code>composer.setVariable()</code>. You can even use it to make a local function from one scene accessible within another. This flexibility makes <code>composer.setVariable()</code> and <code>composer.getVariable()</code> two of the most useful APIs within the Composer toolset.</p>
</div>
</div>
<p><a id="highscores"></a></p>
</section>
<section id="high-scores-scene" class="level2">
<h2>High Scores Scene</h2>
<p>Our high scores scene will basically feature the ability to store and retrieve scores, determine the ten highest, and display them.</p>
<p>First, make a copy of the standard <nobr><code>scene-template.lua</code></nobr> file, included with this chapter’s <a href="https://github.com/coronalabs/GettingStarted06/archive/master.zip">source files</a>. Rename this copy to <code>highscores.lua</code>, place it within your <code>StarExplorer</code> project folder, and open it using your chosen text editor.</p>
<p>As usual, we’ll start by initializing some variables. Place the following code in the <nobr>scene-accessible</nobr> code area:</p>
<pre class="highlight: [11,12,13,14,15,16]; first-line: 6; gutter: true; brush: lua;">-- -----------------------------------------------------------------------------------
-- Code outside of the scene event functions below will only be executed ONCE unless
-- the scene is removed entirely (not recycled) via "composer.removeScene()"
-- -----------------------------------------------------------------------------------

-- Initialize variables
local json = require( "json" )

local scoresTable = {}

local filePath = system.pathForFile( "scores.json", system.DocumentsDirectory )</pre>
<p>Let’s briefly examine these commands:</p>
<ul>
<li><p>With the first command, we load a new resource for our app: the JSON library. <a href="https://www.json.org/">JSON</a> is a convenient format for working with data. If you’re not familiar with JSON, don’t worry — for the purpose of this app, you just need to learn how to use the <nobr>built-in</nobr> <code>json.encode()</code> and <code>json.decode()</code> commands. Respectively, these commands let you take a Lua table, store (encode) its contents in a <nobr>well-understood</nobr> format, and later translate (decode) that data back into a Lua table.</p></li>
<li><p>The next command, <nobr><code>local scoresTable = {}</code></nobr>, simply creates an empty table which will eventually contain the retrieved scores, or an updated list of scores to save.</p></li>
<li><p>The final line generates an absolute path to a JSON file (<code>scores.json</code>) which we’ll use to save the ten highest scores. Don’t worry that this file doesn’t actually exist yet — this command will create the file and initiate a link to it under the variable <code>filePath</code>.</p></li>
</ul>
<div class="guide-notebox-imp">
<div class="notebox-title-imp">
Important
</div>
<p>You may wonder why we’re creating a <strong>file</strong> to store the high scores data. Why not just store them locally in a Lua table? The reason is fundamental to app development in general. Basically, variables which exist in an app’s local memory will be destroyed if the app quits/closes!</p>
<p>Essentially, any data which needs to be accessed at some point after the app quits/closes should be stored in a <strong>persistent</strong> state, and the easiest way to store persistent data is to save it to a file on the device. Furthermore, this file must be stored in a <strong>persistent location</strong>.</p>
<p>To ensure that the <code>scores.json</code> file is placed within a persistent location, we specify <code>system.DocumentsDirectory</code> as the second parameter of the command we just entered. This tells Solar2D to create the <code>scores.json</code> file within the app’s internal “documents” directory. While there are other places we could put the file, we won’t go into details on them here — just remember that the documents directory, referenced by the constant <code>system.DocumentsDirectory</code>, is the only place which provides truly persistent storage for files that are created from within the app. In other words, even if the player quits the app and doesn’t open it again until a month later, the <code>scores.json</code> file will still exist.</p>
</div>
<p><a id="loaddata"></a></p>
</section>
<section id="loading-data" class="level2">
<h2>Loading Data</h2>
<p>Now that we’ve initialized the file for storing scores, let’s write a function to check for any scores which were previously saved. Of course there won’t be any at this point, but we’ll need this function eventually.</p>
<p>Directly following the commands you already added to the <nobr>scene-accessible</nobr> code area, add the following <code>loadScores()</code> function:</p>
<pre class="highlight: [19,20,21,22,23,24,25,26,27,28,29,30,31,32]; first-line: 16; gutter: true; brush: lua;">local filePath = system.pathForFile( "scores.json", system.DocumentsDirectory )


local function loadScores()

    local file = io.open( filePath, "r" )

    if file then
        local contents = file:read( "*a" )
        io.close( file )
        scoresTable = json.decode( contents )
    end

    if ( scoresTable == nil or #scoresTable == 0 ) then
        scoresTable = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }
    end
end</pre>
<p>Dissecting this function, we accomplish the following:</p>
<ul>
<li><p>When working with files containing data, the first step is to confirm that the file exists. The first command inside this function, <nobr><code>local file = io.open( filePath, "r" )</code></nobr>, attempts to open the file <code>scores.json</code> in the <code>system.DocumentsDirectory</code> folder (remember that we set the variable <code>filePath</code> to point to that file and folder). In this command, also note the second parameter, <code>"r"</code>. This tells Solar2D to open the file with <strong>read</strong> access only, but that’s sufficient here because we simply need to read the file contents.</p></li>
<li><p>In the conditional block following, if the file exists, its contents will be dumped into the local variable <code>contents</code>. Once we have its contents, we close the file with <nobr><code>io.close( file )</code></nobr>. Then, using the command <code>json.decode()</code>, we decode <code>contents</code> and store the values in <code>scoresTable</code> — basically, <code>json.decode()</code> converts <code>scores.json</code> into a Lua table which can be used in our app.</p></li>
<li><p>In the final conditional block, just in case the <code>scores.json</code> file is empty or doesn’t exist, we assign <code>scoresTable</code> ten default values of <code>0</code> so that the scene has something to work with.</p></li>
</ul>
<div class="docs-tip-outer">
<div class="docs-tip-inner-left">
<div class="fa fa-cog">

</div>
</div>
<div class="docs-tip-inner-right">
<p>If you want to make things more interesting, start the game with ten default scores that the “computer” scored and challenge the player to beat them! For example:</p>
<pre class="brush: lua;">scoresTable = { 10000, 7500, 5200, 4700, 3500, 3200, 1200, 1100, 800, 500 }</pre>
</div>
</div>
<p><a id="savedata"></a></p>
</section>
<section id="saving-data" class="level2">
<h2>Saving Data</h2>
<p>Saving data is just as easy as reading data. Following the previous function in the <nobr>scene-accessible</nobr> code area, add a <code>saveScores()</code> function:</p>
<pre class="highlight: [35,36,37,38,39,40,41,42,43,44,45,46,47]; first-line: 29; gutter: true; brush: lua;">    if ( scoresTable == nil or #scoresTable == 0 ) then
        scoresTable = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }
    end
end


local function saveScores()

    for i = #scoresTable, 11, -1 do
        table.remove( scoresTable, i )
    end

    local file = io.open( filePath, "w" )

    if file then
        file:write( json.encode( scoresTable ) )
        io.close( file )
    end
end</pre>
<p>This function saves high scores data as follows:</p>
<ul>
<li><p>First, we clear out any unneeded scores from <code>scoresTable</code>. Because we only want to save the highest ten scores, anything beyond that can be discarded. Using a <code>for</code> loop, we step backwards through the table from its total count (<code>#scoresTable</code>) to <code>11</code>, effectively removing all but ten scores.</p></li>
<li><p>Next, we open the <code>scores.json</code> file. Unlike our <code>io.open()</code> call within <code>loadScores()</code>, here we specify <code>"w"</code> as the second parameter. This tells Solar2D to create (write) a new file or overwrite the file if it already exists. It also tells Solar2D to open the file with <strong>write</strong> access which is important because, when saving score data, we need to write data to the file.</p></li>
<li><p>Once the file is successfully open, we call <code>file:write()</code> to write the <code>scoresTable</code> data to the file, converted into JSON via the <code>json.encode()</code> command. Finally, we close the file with <nobr><code>io.close( file )</code></nobr>.</p></li>
</ul>
<p><a id="displayscores"></a></p>
</section>
<section id="displaying-high-scores" class="level2">
<h2>Displaying High Scores</h2>
<p>Before we show the scores to the player, we need to manipulate the <code>scoresTable</code> table slightly. Specifically, we need to add the most recent score to the table and then sort the table entries from highest to lowest.</p>
<p>All of the work for this scene can be done within <code>scene:create()</code>, so let’s focus our attention on that function:</p>
<ol type="1">
<li>Before we can do anything with score data, we need to load the existing scores. Let’s do so by calling the <code>loadScores()</code> function:</li>
</ol>
<div class="code-indent">
<pre class="highlight: [60,61]; first-line: 54; gutter: true; brush: lua;">-- create()
function scene:create( event )

    local sceneGroup = self.view
    -- Code here runs when the scene is first created but has not yet appeared on screen

    -- Load the previous scores
    loadScores()
end</pre>
</div>
<ol start="2" type="1">
<li>Next, let’s insert the player’s most recent score into the <code>scoresTable</code> table. Notice that we get its value by calling <code>composer.getVariable()</code> with a sole parameter of <code>"finalScore"</code>. This exhibits the power of the <code>composer.setVariable()</code> <nobr>command — added to <code>game.lua</code> —</nobr> for setting a <nobr>Composer-accessible</nobr> variable which we can now access in this scene (<code>highscores.lua</code>). Following that, we immediately reset its value to <code>0</code> since we won’t need further record of it.</li>
</ol>
<div class="code-indent">
<pre class="highlight: [63,64,65]; first-line: 60; gutter: true; brush: lua;">    -- Load the previous scores
    loadScores()
    
    -- Insert the saved score from the last game into the table, then reset it
    table.insert( scoresTable, composer.getVariable( "finalScore" ) )
    composer.setVariable( "finalScore", 0 )
end</pre>
</div>
<ol start="3" type="1">
<li>At this point, we don’t know where our score ranks among the existing high scores. It might not even beat the lowest score among the ten highest! To check this, let’s <strong>sort</strong> the table’s values from highest to lowest. This will automatically place our score in the correct order. If it’s not high enough to make the top ten, it will remain in the 11th slot, but since we’ll only show ten scores, you won’t see it on the screen.</li>
</ol>
<div class="code-indent">
<p>To sort the table, we use the Lua <code>table.sort()</code> command. For this to work, we must provide it with the table to sort and a reference to a comparison function (<code>compare()</code>) which determines if items need to swap places. Here we’ve coded the <code>compare()</code> function directly inside of <code>scene:create()</code> because it doesn’t need to be accessible elsewhere.</p>
<pre class="highlight: [67,68,69,70,71]; first-line: 63; gutter: true; brush: lua;">    -- Insert the saved score from the last game into the table, then reset it
    table.insert( scoresTable, composer.getVariable( "finalScore" ) )
    composer.setVariable( "finalScore", 0 )

    -- Sort the table entries from highest to lowest
    local function compare( a, b )
        return a > b
    end
    table.sort( scoresTable, compare )
end</pre>
<p>The <code>compare()</code> function itself takes two values which <code>table.sort()</code> provides. Since we are sorting a table of numbers, the two parameters <code>a</code> and <code>b</code> will be numerical values. The function compares these two values as in <nobr>“is <code>a</code> greater than <code>b</code>?”</nobr> If true, it returns <code>true</code> and <code>table.sort()</code> knows that it needs to swap the values. Essentially, when the <code>table.sort()</code> process finishes, our <code>scoresTable</code> values will be sorted from highest to lowest.</p>
</div>
<ol start="4" type="1">
<li>With the table now sorted, let’s save the data back out to <code>scores.json</code> by calling our <code>saveScores()</code> function:</li>
</ol>
<div class="code-indent">
<pre class="highlight: [73,74]; first-line: 67; gutter: true; brush: lua;">    -- Sort the table entries from highest to lowest
    local function compare( a, b )
        return a > b
    end
    table.sort( scoresTable, compare )

    -- Save the scores
    saveScores()
end</pre>
</div>
<ol start="5" type="1">
<li>Following this, let’s create the scene background and a text object — nothing special here; by now you’re an expert at this!</li>
</ol>
<div class="code-indent">
<pre class="highlight: [76,77,78,80]; first-line: 73; gutter: true; brush: lua;">    -- Save the scores
    saveScores()

    local background = display.newImageRect( sceneGroup, "background.png", 800, 1400 )
    background.x = display.contentCenterX
    background.y = display.contentCenterY
    
    local highScoresHeader = display.newText( sceneGroup, "High Scores", display.contentCenterX, 100, native.systemFont, 44 )
end</pre>
</div>
<ol start="6" type="1">
<li>Next, let’s display the scores using a simple <code>for</code> loop from <code>1</code> to <code>10</code>. For each score, we’ll first set the intended <strong>y</strong> position by calculating a local <code>yPos</code> variable. This will make the scores run down the screen, evenly spaced apart:</li>
</ol>
<div class="code-indent">
<pre class="highlight: [82,83,84,85,86,87]; first-line: 80; gutter: true; brush: lua;">    local highScoresHeader = display.newText( sceneGroup, "High Scores", display.contentCenterX, 100, native.systemFont, 44 )

    for i = 1, 10 do
        if ( scoresTable[i] ) then
            local yPos = 150 + ( i * 56 )

        end
    end
end</pre>
<p>For each score line, we’ll display <strong>two</strong> text objects. On the left will be a rank number from <strong>1)</strong> to <strong>10)</strong>. Directly to its right will be the actual score:</p>
<pre class="highlight: [86,87,88,90,91]; first-line: 82; gutter: true; brush: lua;">    for i = 1, 10 do
        if ( scoresTable[i] ) then
            local yPos = 150 + ( i * 56 )

            local rankNum = display.newText( sceneGroup, i .. ")", display.contentCenterX-50, yPos, native.systemFont, 36 )
            rankNum:setFillColor( 0.8 )
            rankNum.anchorX = 1

            local thisScore = display.newText( sceneGroup, scoresTable[i], display.contentCenterX-30, yPos, native.systemFont, 36 )
            thisScore.anchorX = 0
        end
    end
end</pre>
<p>Most of the above code should be straightforward, but we’re introducing an important new concept in <strong>anchors</strong>. By default, Solar2D positions the <strong>center</strong> of any display object at the <strong>x</strong> and <strong>y</strong> coordinate given. However, sometimes you’ll need to align a series of objects along their edges — here, the list of scores will look best if each rank number is <nobr>right-aligned</nobr> and each score is <nobr>left-aligned</nobr>.</p>
<div class="float-right" style="max-width: 244px; margin-top: 12px; margin-bottom: 16px; clear: left;">
<p><img src="../../../images/docs/anchor-diagram.png" /></p>
</div>
<p>To accomplish this, notice that we set the <code>anchorX</code> property of each object. This property typically ranges between <code>0</code> (left) and <code>1</code> (right), with a default of <code>0.5</code> (center). Since we want each rank number to be <nobr>right-aligned</nobr> with the others, we set <code>anchorX</code> to <code>1</code>, and for each score number, we set <code>anchorX</code> to <code>0</code> for left alignment.</p>
<div class="docs-tip-outer">
<div class="docs-tip-inner-left">
<div class="fa fa-cog">

</div>
</div>
<div class="docs-tip-inner-right">
<p>Naturally, Solar2D also supports vertical anchor points with the <code>anchorY</code> property. Similar to its horizontal counterpart, this property typically ranges between <code>0</code> (top) and <code>1</code> (bottom), with a default of <code>0.5</code> (center). Anchors can even be set outside of the <code>0</code> to <code>1</code> range, although this usage is less common. Setting either <code>anchorX</code> or <code>anchorY</code> to values less than <code>0</code> or greater than <code>1</code> will place the anchor point conceptually somewhere in space outside of the object’s edge boundaries, which can be useful in some instances.</p>
</div>
</div>
</div>
<ol start="7" type="1">
<li>Finally, let’s create a button (text object) to go back to the menu. This is just like the text buttons you created in the menu scene, and its <code>"tap"</code> event listener will call a basic <code>gotoMenu()</code> function which we’ll write next.</li>
</ol>
<div class="code-indent">
<pre class="highlight: [95,96,97]; first-line: 92; gutter: true; brush: lua;">        end
    end

    local menuButton = display.newText( sceneGroup, "Menu", display.contentCenterX, 810, native.systemFont, 44 )
    menuButton:setFillColor( 0.75, 0.78, 1 )
    menuButton:addEventListener( "tap", gotoMenu )
end</pre>
</div>
<p><a id="leavescene"></a></p>
</section>
<section id="leaving-the-scene" class="level2">
<h2>Leaving the Scene</h2>
<p>Back up in the <nobr>scene-accessible</nobr> code area, we need to add the function which handles the <code>"tap"</code> event for the <code>menuButton</code> object. This is straightforward enough:</p>
<pre class="highlight: [50,51,52]; first-line: 50; gutter: true; brush: lua;">local function gotoMenu()
    composer.gotoScene( "menu", { time=800, effect="crossFade" } )
end


-- -----------------------------------------------------------------------------------
-- Scene event functions
-- -----------------------------------------------------------------------------------</pre>
<p><a id="cleanup"></a></p>
</section>
<section id="scene-cleanup" class="level2">
<h2>Scene Cleanup</h2>
<p>Similar to the <code>game.lua</code> scene, let’s remove the <code>highscores.lua</code> scene within its own <code>scene:hide()</code> function. This will remove the scene from memory when players return to the menu scene.</p>
<p>Inside the <code>scene:hide()</code> function, add the following highlighted line:</p>
<pre class="highlight: [133]; first-line: 122; gutter: true; brush: lua;">-- hide()
function scene:hide( event )

    local sceneGroup = self.view
    local phase = event.phase

    if ( phase == "will" ) then
        -- Code here runs when the scene is on screen (but is about to go off screen)

    elseif ( phase == "did" ) then
        -- Code here runs immediately after the scene goes entirely off screen
        composer.removeScene( "highscores" )
    end
end</pre>
<div class="docs-tip-outer docs-tip-color-action">
<div class="docs-tip-inner-left">
<div class="fa fa-video-camera" style="font-size: 29px; padding-top: 4px;">

</div>
</div>
<div class="docs-tip-inner-right">
<p>This wraps up our high score scene! Save your modified <code>highscores.lua</code> and <code>game.lua</code> files and then relaunch the Simulator. Now you should be able to play the game and see your scores saved/sorted in the high scores scene.</p>
</div>
</div>
<div class="docs-tip-outer" style="background-color: #ffa752;">
<div class="docs-tip-inner-left">
<div class="fa fa-check-square" style="font-size: 34px; padding-left: 1px; padding-top: 4px;">

</div>
</div>
<div class="docs-tip-inner-right">
<p>This scene is relatively simple, but if your code isn’t working as expected, please compare it to the <code>highscores.lua</code> file bundled with this chapter’s <a href="https://github.com/coronalabs/GettingStarted06/archive/master.zip">source files</a>.</p>
</div>
</div>
<p><a id="concepts"></a></p>
</section>
<section id="chapter-concepts" class="level2">
<h2>Chapter Concepts</h2>
<p>We’ve covered several more important concepts in this chapter:</p>
<div class="inner-table">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Command/Property</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/library/system/pathForFile.html">system.pathForFile()</a></td>
<td style="text-align: left;">Generates an absolute path using <nobr>system-defined</nobr> directories as the base.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="../../../api/library/io/open.html">io.open()</a></td>
<td style="text-align: left;">Opens a file for reading or writing.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/library/io/close.html">io.close()</a></td>
<td style="text-align: left;">Closes an open file handle.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="../../../api/type/File/read.html">file:read()</a></td>
<td style="text-align: left;">Reads a file, according to the given formats which specify what to read.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/type/File/write.html">file:write()</a></td>
<td style="text-align: left;">Writes the value of each of its arguments to the file.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="../../../api/library/json/decode.html">json.decode()</a></td>
<td style="text-align: left;">Decodes a JSON-encoded data structure and returns a Lua table with the data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/library/json/encode.html">json.encode()</a></td>
<td style="text-align: left;">Converts a Lua table into a <nobr>JSON-encoded</nobr> string.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="../../../api/library/composer/setVariable.html">composer.setVariable()</a></td>
<td style="text-align: left;">Sets a variable declared in one scene to be accessible throughout the entire Composer app.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/library/composer/getVariable.html">composer.getVariable()</a></td>
<td style="text-align: left;">Allows you to retrieve the value of any variable set via <a href="../../../api/library/composer/setVariable.html">composer.setVariable()</a>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="../../../api/library/table/sort.html">table.sort()</a></td>
<td style="text-align: left;">Sorts table elements in a given order.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="../../../api/type/DisplayObject/anchorX.html">object.anchorX</a></td>
<td style="text-align: left;">Property which allows you to control the alignment of a display object along the <strong>x</strong> direction.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="../../../api/type/DisplayObject/anchorY.html">object.anchorY</a></td>
<td style="text-align: left;">Property which allows you to control the alignment of a display object along the <strong>y</strong> direction.</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="section" class="level2">
<h2></h2>
<div class="walkthrough-nav">
<p><strong>⟨</strong> <a href="../../../guide/programming/05/index.html">Chapter 5 — Converting the Game to Composer</a> <em>|</em> <a href="../../../guide/programming/07/index.html">Chapter 7 — Sounds and Music</a> <strong>⟩</strong></p>
</div>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
