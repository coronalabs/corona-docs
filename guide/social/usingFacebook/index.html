<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Developer Guides | Communication/Social</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../../css/style.css" />
  <link rel="stylesheet" href="../../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="../../../api/index.html">API Reference</a></li>
<li><a href="../../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../native/index.html">Solar2D Native</a></li>
<li><a href="../../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#implementing-facebook">Implementing Facebook</a><ul>
<li><a href="#including-the-plugin">Including the Plugin</a></li>
<li><a href="#user-experience">User Experience</a><ul>
<li><a href="#login-considerations">Login Considerations</a></li>
</ul></li>
<li><a href="#ios-requirements">iOS Requirements</a></li>
<li><a href="#android-requirements">Android Requirements</a></li>
<li><a href="#initialization">Initialization</a></li>
<li><a href="#logging-inout">Logging In/Out</a></li>
<li><a href="#facebook-listener">Facebook Listener</a></li>
<li><a href="#making-requests">Making Requests</a></li>
<li><a href="#using-dialogs">Using Dialogs</a></li>
<li><a href="#published-installs">Published Installs</a></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../../guide/index.html">Developer Guides</a>  ▸  <a href="../../../guide/social/index.html">Communication/Social</a>
</div>
<section id="implementing-facebook" class="level1">
<h1>Implementing Facebook</h1>
<p>This guide discusses how to implement common Facebook tasks and processes in your Corona app.</p>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<p>If you just need to perform basic tasks like posting a Facebook user’s status update, the <a href="../../../plugin/CoronaProvider_native_popup_social/index.html">Social Popup</a> plugin (Android) or the <a href="../../../plugin/CoronaProvider_native_popup_activity/index.html">Activity Popup</a> plugin (iOS) is the easiest method. However, if you need to perform more advanced tasks or create a more complete integration of Facebook within an app, please proceed with the instructions in this guide.</p>
</div>
<div class="guides-toc">
<ul>
<li><a href="#plugin">Including the Plugin</a></li>
<li><a href="#user-experience">User Experience</a></li>
<li><a href="#ios-requirements">iOS Requirements</a></li>
<li><a href="#android-requirements">Android Requirements</a></li>
<li><a href="#login-logout">Logging In/Out</a></li>
<li><a href="#listener">Facebook Listener</a></li>
<li><a href="#requests">Making Requests</a></li>
<li><a href="#dialogs">Using Dialogs</a></li>
<li><a href="#published-installs">Published Installs</a></li>
</ul>
</div>
<p><a id="plugin"></a></p>
<section id="including-the-plugin" class="level2">
<h2>Including the Plugin</h2>
<div class="guide-notebox-imp">
<div class="notebox-title-imp">
Important
</div>
<p>To begin using the <a href="../../../plugin/facebook-v4a/index.html">Facebook</a> plugin, you must first <a href="https://developers.facebook.com/">register</a> as a Facebook developer and configure your app in the <a href="https://developers.facebook.com/">Facebook Developer Portal</a>. Please see the <a href="../../../guide/social/setupFacebook/index.html">Facebook Portal Setup</a> guide for assistance with this process — it requires some <strong>very</strong> precise information and it’s imporant to follow every step carefully.</p>
</div>
<p>As with all Corona plugins, you must include the <a href="../../../plugin/facebook-v4a/index.html">Facebook</a> plugin within the <code>plugins</code> table of <code>build.settings</code>:</p>
<pre class="brush: lua;">settings = {

    plugins =
    {
        ["plugin.facebook.v4a"] =
        {
            publisherId = "com.coronalabs"
        },
    },
}</pre>
<p>Then, you must <code>require()</code> the plugin in any module where you need to access its methods and properties:</p>
<pre class="brush: lua;">local facebook = require( "plugin.facebook.v4a" )</pre>
<p><a id="user-experience"></a></p>
</section>
<section id="user-experience" class="level2">
<h2>User Experience</h2>
<p>The user experience for different components of the Facebook plugin vary depending on the presence of a native Facebook app. In many cases, if a native Facebook app is on the device, operations like logging in or presenting the <a href="https://developers.facebook.com/docs/sharing/reference/share-dialog">Share Dialog</a> may try to redirect the heavy lifting to the Facebook app. The cases where a redirect to the Facebook app occurs has changed a lot throughout the history of the Facebook SDK, so your app should be prepared for a Facebook operation to suspend and then resume your app after the Facebook operation completes.</p>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<p>On Android, a native Facebook app could be the standard <a href="https://play.google.com/store/apps/details?id=com.facebook.katana&amp;hl=en">Facebook app</a> or the <a href="https://play.google.com/store/apps/details?id=com.facebook.lite&amp;hl=en">Facebook Lite app</a>. Each native app may result in a different user experience.</p>
</div>
<section id="login-considerations" class="level3">
<h3>Login Considerations</h3>
<p>Before the Facebook Graph API can be used, the app must successfully log in to Facebook. Then, it must gather the required authentication information and the specific permissions required by the app.</p>
<ul>
<li><p>If the mobile device has a native Facebook app installed, your app will launch it and ask for the necessary permissions. When this happens, your app is temporarily suspended and placed into the background while the native Facebook app runs. When complete (the user has either granted permission or has cancelled), the Facebook app will try to restore your app and put it in the foreground, bringing with it the information about your permission request.</p></li>
<li><p>If the mobile device does <strong>not</strong> have a native Facebook app installed, it will use Facebook’s website to log in. This happens through a web view, so your app is never actually suspended to the background. In general, the <nobr>web-based</nobr> login method is very reliable, but you (the developer) cannot control if your app’s user does or doesn’t have the native Facebook app installed. Therefore, you must support both methods.</p></li>
<li><p>Facebook encourages developers to delay logging in to Facebook until necessary, and at the user’s choosing. Automatically logging the user in within <code>main.lua</code> is discouraged.</p></li>
</ul>
<div class="guide-notebox">
<div class="notebox-title">
Notes
</div>
<ul>
<li><p>The Facebook v4 plugin uses a <a href="https://developer.apple.com/reference/safariservices/sfsafariviewcontroller">SFSafariViewController</a> to log in on iOS 9 and above.</p></li>
<li><p>On low-end Android devices, it’s more likely that a Facebook app will fail to restore your app when used for logging in. This may be caused by the Android OS terminating your app because it’s running low on memory.</p></li>
</ul>
</div>
<p><a id="ios-requirements"></a></p>
</section>
</section>
<section id="ios-requirements" class="level2">
<h2>iOS Requirements</h2>
<p>If your app is for iOS, you must include specific aspects within your <code>build.settings</code> file to ensure that the native Facebook app functions properly. Please see the <a href="../../../plugin/facebook-v4a/index.html#ios">plugin documentation</a> for details.</p>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<p>If you want to publish multiple iOS apps that use the same Facebook App ID, for example a trial version and full version of the same app, this can be accomplished via a <code>FacebookUrlSchemeSuffix</code> key in the <nobr><code>iphone</code> → <code>plist</code></nobr> table of <code>build.settings</code>, along with other minor edits as noted below. See Facebook’s <a href="https://developers.facebook.com/docs/ios/troubleshooting">iOS SDK FAQ</a> for more info.</p>
<pre class="brush: lua;">settings = {

    iphone =
    {
        plist =
        {
            FacebookUrlSchemeSuffix = "suffix",
            ["URL types"] =
            {
                item =
                {
                    ["URL Schemes"] = { ["Item 0"] = "fbXXXXXXXXXXsuffix" },  -- Replace XXXXXXXXXX with your Facebook App ID
                },
            },

            MinimumOSVersion = "8.0",
            UIApplicationExitsOnSuspend = false,
            FacebookAppID = "XXXXXXXXXX",  -- Replace XXXXXXXXXX with your Facebook App ID
            CFBundleURLTypes =
            {
                { CFBundleURLSchemes = { "fbXXXXXXXXXXsuffix", } }  -- Replace XXXXXXXXXX with your Facebook App ID
            },
        }
    }
}</pre>
</div>
<p><a id="android-requirements"></a></p>
</section>
<section id="android-requirements" class="level2">
<h2>Android Requirements</h2>
<p>On Android, Facebook uses your app <strong>Package Name</strong>, for example <code>com.yoursite.yourapp</code>. To ensure that the native Facebook app functions properly, you must provide Facebook’s portal with two important pieces of information — these include the <strong>Class Name</strong> of <code>com.ansca.corona.CoronaActivity</code> and the <strong>Key Hash</strong> gathered from the keystore you built your app with. These are discussed in the <a href="../../../guide/social/setupFacebook/index.html">Facebook Portal Setup</a> guide.</p>
<p>Furthermore, the Facebook v4 plugin needs to know about your unique Facebook App ID (<code>facebookAppId</code>):</p>
<pre class="brush: lua;">settings =
{
    android =
    {
        facebookAppId = "XXXXXXXXXX",  -- Replace XXXXXXXXXX with your Facebook App ID
    },
}</pre>
<p><a id="Initialization"></a></p>
</section>
<section id="initialization" class="level2">
<h2>Initialization</h2>
<p>The Facebook plugin begins initializing when you require the plugin the first time. Depending on network conditions, this could take several seconds. In your <code>main.lua</code> file, you can create a listener function to notify you when initialization is complete and reference that function within <a href="../../../plugin/facebook-v4a/init.html">facebook.init()</a>:</p>
<pre class="brush: lua;">local function facebookListener( event )

    if ( "fbinit" == event.name ) then

        print( "Facebook initialized" )

        -- Initialization complete; call "facebook.publishInstall()"
        facebook.publishInstall()

    elseif ( "fbconnect" == event.name ) then

        if ( "session" == event.type ) then
            -- Handle login event and try to share the link again if needed
        elseif ( "dialog" == event.type ) then
            -- Handle dialog event
        end
    end
end

-- Set the "fbinit" listener to be triggered when initialization is complete
facebook.init( facebookListener )</pre>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<p>This listener function can be the same function that you’ll use for Facebook requests, dialogs, and logging in, but if you prefer to use a different function for those aspects, simply specify that function reference within <a href="../../../plugin/facebook-v4a/login.html">facebook.login()</a>.</p>
</div>
<p><a id="login-logout"></a></p>
</section>
<section id="logging-inout" class="level2">
<h2>Logging In/Out</h2>
<p>Logging in to Facebook is accomplished through <a href="../../../plugin/facebook-v4a/login.html">facebook.login()</a>. If you didn’t already set a <a href="../../../api/type/Listener.html">listener</a> function via <a href="../../../plugin/facebook-v4a/init.html">facebook.init()</a> or <a href="../../../plugin/facebook-v4a/setFBConnectListener.html">facebook.setFBConnectListener()</a>, you can set it by passing the listener reference as the first argument to <a href="../../../plugin/facebook-v4a/login.html">facebook.login()</a>.</p>
<p>Secondly, via <a href="../../../plugin/facebook-v4a/login.html">facebook.login()</a>, you can request an array of <a href="https://developers.facebook.com/docs/facebook-login/permissions">permissions</a>. Both <nobr><strong>read-only</strong></nobr> and <strong>publishable</strong> permissions can be specified, with some caveats which are outlined in the <a href="../../../plugin/facebook-v4a/login.html">facebook.login()</a> documentation.</p>
<p>Putting these two aspects together, a login call might look like this:</p>
<pre class="brush: lua;">facebook.login( facebookListener, { "email", "user_birthday" } )</pre>
<p>Logging the user out is even easier. To disconnect the app from Facebook’s services, simply call <a href="../../../plugin/facebook-v4a/logout.html">facebook.logout()</a>. Note, however, that this does <strong>not</strong> log the device’s user out of Facebook entirely — if the user is logged into Facebook through a native Facebook app or the device’s browser, they will remain logged in via those means.</p>
<pre class="brush: lua;">facebook.logout()</pre>
<p><a id="listener"></a></p>
</section>
<section id="facebook-listener" class="level2">
<h2>Facebook Listener</h2>
<p>All Facebook requests will call the listener function you passed to <a href="../../../plugin/facebook-v4a/init.html">facebook.init()</a>, <a href="../../../plugin/facebook-v4a/login.html">facebook.login()</a>, or set via <a href="../../../plugin/facebook-v4a/setFBConnectListener.html">facebook.setFBConnectListener()</a>. For example:</p>
<pre class="brush: lua;">local function facebookListener( event )

    if ( "fbinit" == event.name ) then

        print( "Facebook initialized" )

    elseif ( "fbconnect" == event.name ) then

        -- Event type of "session" covers various login/logout events
        if ( "session" == event.type ) then
            -- Handle login event and try to share the link again if needed

        -- Event.type of "request" handles calls to various Graph API functionalities
        elseif ( "request" == event.type ) then
            if not event.isError then
                -- Process response data here
            end

        -- Event.type of "dialog" indicates standard popup boxes that can be displayed
        elseif ( "dialog" == event.type ) then
            -- Handle dialog event
        end
    end
end</pre>
<p><a id="requests"></a></p>
</section>
<section id="making-requests" class="level2">
<h2>Making Requests</h2>
<p>To make different Graph API requests, use the <a href="../../../plugin/facebook-v4a/request.html">facebook.request()</a> call. By default, this call makes <nobr><code>HTTP GET</code></nobr> requests to Facebook. If you wish to use another method, set the second parameter (<code>httpMethod</code>) to a value outlined in the <a href="../../../plugin/facebook-v4a/request.html">facebook.request()</a> documentation.</p>
<pre class="brush: lua;">facebook.request( path [, httpMethod] [, params] )</pre>
<p>The only required parameter is <code>path</code> which is based on the <a href="https://developers.facebook.com/docs/graph-api">Facebook Graph API</a> path. This will typically be the REST object that you want to access. For example, the following command will retrieve the latest posts from the user’s account feed:</p>
<pre class="brush: lua;">facebook.request( "me/feed" )</pre>
<p>Some Graph API calls also require parameters to be passed to <a href="../../../plugin/facebook-v4a/request.html">facebook.request()</a>. This is done via the optional <code>params</code> table, for instance:</p>
<pre class="brush: lua;">facebook.request( "me/feed", "POST", { message="Hello Facebook" } )</pre>
<p>To upload a photo to your Facebook photo album, the <code>params</code> table can be filled in based on the standard Graph API parameters found <a href="https://developers.facebook.com/docs/graph-api/reference/photo#Creating">here</a>:</p>
<pre class="brush: lua;">local attachment = {
    caption = "Corona icon file",
    url = "https://coronalabs.com/wordpress/wp-content/uploads/2020/04/Solar2D-App-Icon-RGB-512.png",
}
facebook.request( "me/photos", "POST", attachment )</pre>
<p>When <a href="../../../plugin/facebook-v4a/request.html">facebook.request()</a> calls complete, your Facebook listener function will be called with an <code>event.type</code> of <code>"request"</code>. Facebook generally returns your data as <code>event.response</code>, a <nobr>JSON-encoded</nobr> table of data. To convert this into a Lua table, call <a href="../../../api/library/json/decode.html">json.decode()</a>, remembering to first <code>require()</code> the JSON library.</p>
<p>To learn more about which requests, parameters, and data Facebook provides, please see the <a href="https://developers.facebook.com/docs/graph-api">Facebook Graph API</a> documentation.</p>
<p><a id="dialogs"></a></p>
</section>
<section id="using-dialogs" class="level2">
<h2>Using Dialogs</h2>
<p>Facebook requires that some tasks be done through dialogs they control. To use a dialog, call the <a href="../../../plugin/facebook-v4a/showDialog.html">facebook.showDialog()</a> function:</p>
<pre class="brush: lua;">facebook.showDialog( action, params )</pre>
<p>For this call, the <code>action</code> parameter specifies the dialog type:</p>
<ul>
<li>The <a href="https://developers.facebook.com/docs/sharing/reference/share-dialog">Share Dialog</a> displays the Facebook dialog for sharing content. For example, if you wanted to post a link to your Facebook wall and send a message along with it, you could do something like:</li>
</ul>
<div class="code-indent">
<pre class="brush: lua;">facebook.showDialog( "link",
{
    name = "Implementing Facebook with Corona",
    link = "https://docs.coronalabs.com/guide/social/usingFacebook/index.html"
})</pre>
</div>
<ul>
<li>The <a href="https://developers.facebook.com/docs/games/services/gamerequests">Game Request Dialog</a> displays a native view which allows the user to send game requests to their choice of friends. For instance:</li>
</ul>
<div class="code-indent">
<pre class="brush: lua;">facebook.showDialog( "requests",
{
    message = "You should download this game!",
    filter = "APP_NON_USERS"
})</pre>
</div>
<p>Observe how the <code>params</code> argument is a table of key/value pairs which gets passed to the Facebook API call. The keys that you pass correspond to specific options which are available for the dialog. See the <a href="../../../plugin/facebook-v4a/showDialog.html">facebook.showDialog()</a> documentation for details.</p>
<p><a id="published-installs"></a></p>
</section>
<section id="published-installs" class="level2">
<h2>Published Installs</h2>
<p>While not part of the Graph API, <strong>Published Installs</strong> is a way for apps to participate in Facebook’s mobile ad campaign which can report (to Facebook) that the app has been installed. This process is simple and there is no callback information or need to call <a href="../../../plugin/facebook-v4a/login.html">facebook.login()</a> — just call <a href="../../../plugin/facebook-v4a/publishInstall.html">facebook.publishInstall()</a>:</p>
<pre class="brush: lua;">facebook.publishInstall()</pre>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
