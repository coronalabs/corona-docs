<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Solar2D Native | Corona C Functions | CoronaGraphics.h | CoronaExternalTextureCallbacks</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../../css/style.css" />
  <link rel="stylesheet" href="../../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="../../../api/index.html">API Reference</a></li>
<li><a href="../../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../native/index.html">Solar2D Native</a></li>
<li><a href="../../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#coronaexternaltexturecallbacks">CoronaExternalTextureCallbacks</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#syntax">Syntax</a><ul>
<li><a href="#size-required">size <sub><sup>(required)</sup></sub></a></li>
<li><a href="#getwidth-required">getWidth <sub><sup>(required)</sup></sub></a></li>
<li><a href="#getheight-required">getHeight <sub><sup>(required)</sup></sub></a></li>
<li><a href="#onrequestbitmap-required">onRequestBitmap <sub><sup>(required)</sup></sub></a></li>
<li><a href="#onreleasebitmap-optional">onReleaseBitmap <sub><sup>(optional)</sup></sub></a></li>
<li><a href="#getformat-optional">getFormat <sub><sup>(optional)</sup></sub></a></li>
<li><a href="#onfinalize-optional">onFinalize <sub><sup>(optional)</sup></sub></a></li>
<li><a href="#ongetfield-optional">onGetField <sub><sup>(optional)</sup></sub></a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../../native/index.html">Solar2D Native</a>  ▸  <a href="../../../native/C/index.html">Corona C Functions</a>  ▸  <a href="../../../native/C/CoronaGraphics/index.html">CoronaGraphics.h</a>  ▸  <a href="../../../native/C/CoronaGraphics/CoronaExternalTextureCallbacks.html">CoronaExternalTextureCallbacks</a>
</div>
<section id="coronaexternaltexturecallbacks" class="level1">
<h1>CoronaExternalTextureCallbacks</h1>
<blockquote>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Revision</strong></td>
<td style="text-align: left;"><a href="https://solar2d.com/download/">Release 2024.3703</a></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Keywords</strong></td>
<td style="text-align: left;">iOS, Solar2D Native, C, CoronaGraphics.h, CoronaExternalTextureCallbacks</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>See also</strong></td>
<td style="text-align: left;"><a href="../../../native/C/CoronaGraphics/index.html">CoronaGraphics.h</a></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><a href="../../../native/C/index.html">Corona C Functions</a></td>
</tr>
</tbody>
</table>
</blockquote>
<section id="overview" class="level2">
<h2>Overview</h2>
<p>This structure contains fields which provide information about the texture and callbacks to be invoked by Corona when events occur or when Corona is requesting information about the texture. Textures are managed by Corona and plugins have no control on when the texture is to be released. Thus, information about a texture’s bitmap must be available upon request.</p>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<p>Always initialize an instance of this structure with zeros. Some of the fields are optional and the texture can be created even if they are <code>NULL</code>. Other fields are required, however, and the texture will not be pushed if they aren’t present.</p>
<pre class="brush: lua; c">CoronaExternalTextureCallbacks callbacks;
memset(&callbacks, 0, sizeof(CoronaExternalTextureCallbacks));
callbacks.size = sizeof(CoronaExternalTextureCallbacks);</pre>
</div>
</section>
<section id="syntax" class="level2">
<h2>Syntax</h2>
<pre class="brush: lua; c">typedef struct CoronaExternalTextureCallbacks
{
    unsigned long size;
    unsigned int (*getWidth)(void* userData);
    unsigned int (*getHeight)(void* userData);
    const void* (*onRequestBitmap)(void* userData);
    void (*onReleaseBitmap)(void* userData);
    CoronaExternalBitmapFormat (*getFormat)(void* userData);
    void (*onFinalize)(void *userData);
    int (*onGetField)(lua_State *L, const char *field, void* userData);
} CoronaExternalTextureCallbacks;</pre>
<section id="size-required" class="level5">
<h5>size <sub><sup>(required)</sup></sub></h5>
<p>When creating an instance of this type, set this member to the number of bytes the <code>CoronaExternalTextureCallbacks</code> type is. This field is used for identifying the API version.</p>
<pre class="brush: lua; c">size = sizeof(CoronaExternalTextureCallbacks);</pre>
</section>
<section id="getwidth-required" class="level5">
<h5>getWidth <sub><sup>(required)</sup></sub></h5>
<p>Callback that will be invoked when Corona is requesting the plugin to provide the bitmap’s pixel width. This callback receives the <code>userData</code> pointer passed when the texture resource was created. Note that some bitmap formats, such as <nobr>8-bit</nobr> masks, require the width to be a multiple of 4 bytes.</p>
</section>
<section id="getheight-required" class="level5">
<h5>getHeight <sub><sup>(required)</sup></sub></h5>
<p>Callback that will be invoked when Corona is requesting the plugin to provide the bitmap’s pixel height. This callback receives the <code>userData</code> pointer passed when the texture resource was created.</p>
</section>
<section id="onrequestbitmap-required" class="level5">
<h5>onRequestBitmap <sub><sup>(required)</sup></sub></h5>
<p>Callback that will be invoked by Corona when the bitmap’s pixel array has been requested by Corona’s rendering system. This function call will always be followed by a call to the <code>onReleaseBitmap</code> callback. This callback receives the <code>userData</code> pointer passed when the texture resource was created.</p>
<div class="guide-notebox">
<div class="notebox-title">
Notes
</div>
<ul>
<li><p>This function must return a valid pointer to the data containing bitmap information. Corona expects bitmap data to be a <nobr>row-by-row</nobr> array of pixels starting from the top left of the image, and each pixel is represented by <nobr><code>bpp = CoronaExternalFormatBPP(getFormat())</code></nobr> bytes. Each color channel uses 1 byte and is ordered the same as the format name, left to right. So, with RGBA format, the R index is <code>0</code>.</p></li>
<li><p>The overall size of memory must be at least…</p></li>
</ul>
<div class="code-indent">
<pre class="brush: lua; c">unsigned int bitmapSizeInBytes = getWidth() * getHeight() * bytesPerPixel;</pre>
</div>
<ul>
<li>Accessing the <nobr>left-most</nobr> value of the bitmap (R in RGBA) could be written as…</li>
</ul>
<div class="code-indent">
<pre class="brush: lua; c">void* byteArray = onRequestBitmap();
int bytesPerPixel = CoronaExternalFormatBPP(getFormat());
int red = (int)byteArray[((Y * getWidth()) + X) * bytesPerPixel];</pre>
</div>
<ul>
<li>Remember that the default format, RGBA, uses premultiplied alpha.</li>
</ul>
</div>
</section>
<section id="onreleasebitmap-optional" class="level5">
<h5>onReleaseBitmap <sub><sup>(optional)</sup></sub></h5>
<p>Callback that will be invoked by Corona to notify the plugin that the texture bitmap’s data is no longer required, meaning that the plugin can delete the bitmap data from memory. After this callback is invoked, the pointer previously returned by the <code>onRequestBitmap</code> callback is no longer expected to be valid. This callback receives the <code>userData</code> pointer passed when the texture resource was created.</p>
</section>
<section id="getformat-optional" class="level5">
<h5>getFormat <sub><sup>(optional)</sup></sub></h5>
<p>Callback that will be invoked by Corona when requesting the pixel format of the bitmap. This callback receives the <code>userData</code> pointer passed when the texture resource was created. This must return a <a href="../../../native/C/CoronaGraphics/CoronaExternalBitmapFormat.html">CoronaExternalBitmapFormat</a> enum constant, such as <code>kExternalBitmapFormat_RGBA</code>.</p>
</section>
<section id="onfinalize-optional" class="level5">
<h5>onFinalize <sub><sup>(optional)</sup></sub></h5>
<p>Callback that will be invoked by Corona to notify the plugin that the Lua <a href="../../../api/type/TextureResourceExternal/index.html">TextureResourceExternal</a> object is about to be destroyed. After this callback is invoked, no callbacks or returned bitmap pointers can be accessed. Essentially, this releases all objects and resources associated with this texture resource. This callback receives the <code>userData</code> pointer passed when the texture resource was created.</p>
</section>
<section id="ongetfield-optional" class="level5">
<h5>onGetField <sub><sup>(optional)</sup></sub></h5>
<p>Callback to be invoked when an unknown Lua property has been accessed from the Lua <a href="../../../api/type/TextureResourceExternal/index.html">TextureResourceExternal</a> object. This is the plugin’s opportunity to provide custom <nobr>read-only</nobr> fields from the Lua object. Argument <code>field</code> provides the name of the property being accessed from the <a href="../../../api/type/TextureResourceExternal/index.html">TextureResourceExternal</a> object. Argument <code>userData</code> is the pointer passed when the texture resource was created. This function returns the number of values pushed onto the Lua stack.</p>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
