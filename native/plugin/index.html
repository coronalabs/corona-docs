<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Solar2D Native | Plugins</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../css/style.css" />
  <link rel="stylesheet" href="../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../guide/index.html">Guides</a></li>
<li><a href="../../api/index.html">API Reference</a></li>
<li><a href="../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../plugin/index.html">Plugins</a></li>
<li><a href="../../native/index.html">Solar2D Native</a></li>
<li><a href="../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#plugins">Plugins</a><ul>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#using-plugins">Using Plugins</a><ul>
<li><a href="#solar2d">Solar2D</a></li>
<li><a href="#solar2d-native">Solar2D Native</a></li>
</ul></li>
<li><a href="#plugin-projects">Plugin Projects</a><ul>
<li><a href="#ios">iOS</a></li>
<li><a href="#android">Android</a></li>
</ul></li>
<li><a href="#coding-plugins">Coding Plugins</a><ul>
<li><a href="#pure-lua">Pure Lua</a></li>
<li><a href="#native-c">Native C</a></li>
<li><a href="#native-java">Native Java</a></li>
<li><a href="#lua-native">Lua + Native</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../native/index.html">Solar2D Native</a>  ▸  <a href="../../native/plugin/index.html">Plugins</a>
</div>
<section id="plugins" class="level1">
<h1>Plugins</h1>
<p>Plugins allow you to extend the functionality of Solar2D. This guide outlines the fundamental details.</p>
<div class="docs-tip-outer">
<div class="docs-tip-inner-left">
<div class="fa fa-cog">

</div>
</div>
<div class="docs-tip-inner-right">
<p>Solar2D runs Solar2D Free Plugin directory at <a href="https://plugins.solar2d.com/">plugins.solar2d.com</a>. If you created a plugin please submit it to the Solar2D Free Plugin Directory. You can either submit link where one can get your plugin, or distribute it for free. Alternatively, you may submit it to the <a href="https://www.solar2dplugins.com/">Solar2D Plugins Marketplace</a>, please see the <a href="https://www.solar2dplugins.com/asset-packaging-guidelines">Asset Packaging Guidelines</a>.</p>
</div>
</div>
<div class="guides-toc">
<ul>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#using">Using Plugins</a></li>
<li><a href="#projects">Plugin Projects</a></li>
<li><a href="#coding">Coding Plugins</a></li>
</ul>
</div>
<p><a id="architecture"></a></p>
<section id="architecture" class="level2">
<h2>Architecture</h2>
<p>Solar2D plugins leverage Lua’s module system in which plugins are lazily loaded by a corresponding call to the Lua <a href="../../api/library/package/require.html">require()</a> function.</p>
<p>Typically, these plugins are just shared native libraries which are supported on platforms like <nobr>macOS (<code>.dylib</code>)</nobr>, <nobr>Windows (<code>.dll</code>)</nobr>, and <nobr>Android (<code>.so</code>)</nobr>.</p>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<ul>
<li>On iOS, shared libraries are not supported, so plugins must be static libraries (<code>.a</code>).</li>
<li>On Android, it’s often convenient to create pure Java plugins (<code>.jar</code>).</li>
</ul>
<p>In these two cases, Solar2D adds special loaders which ensure that these plugins can be easily loaded, assuming certain conventions are followed.</p>
</div>
<p><a id="using"></a></p>
</section>
<section id="using-plugins" class="level2">
<h2>Using Plugins</h2>
<section id="solar2d" class="level3">
<h3>Solar2D</h3>
<p>Plugins for Solar2D are hosted in a number of places. Many are available at <a href="https://plugins.solar2d.com/">Free Plugins Directory</a>, <a href="https://solar2dmarketplace.com/">Solar2D Marketplace</a>, and <a href="https://www.solar2dplugins.com/">Solar2D Plugins Marketplace</a>. You can incorporate a plugin by adding an entry to the <code>plugins</code> table of <code>build.settings</code>, for example:</p>
<pre class="highlight: [5,6,7,8]; first-line: 1; gutter: false; brush: lua;">settings =
{
    plugins =
    {
        ["plugin.myPlugin"] =
        {
            publisherId = "com.domainname"
        },
    },
}</pre>
<p>Each plugin host will provide specific build.settings for the individual plugin.</p>
<p>When added in this manner, Solar2D will integrate the plugin during the build phase.</p>
<p>From there, the plugin can be loaded using the standard Lua <a href="../../api/library/package/require.html">require()</a> function, for instance:</p>
<pre class="brush: lua;">local myPlugin = require( "plugin.myPlugin" )</pre>
</section>
<section id="solar2d-native" class="level3">
<h3>Solar2D Native</h3>
<p>Native plugins can easily be added to your iOS or Android project.</p>
<p>On iOS, plugins will be in the form of static library (<code>.a</code>) files that need to be linked into your app executable.</p>
<p>On Android, plugins can come in the form of <code>.so</code> (shared library), <code>.jar</code> or <code>.aar</code> files.</p>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<p>When you add a plugin via Solar2D Native, be aware of the following:</p>
<ul>
<li><strong>Resources</strong> — If the plugin comes with resources, you should ensure those resources are available.</li>
<li><strong>Dependencies</strong> — If the plugin depends on linking to system frameworks or libraries, ensure the appropriate linker flags are set.</li>
</ul>
</div>
<p><a id="projects"></a></p>
</section>
</section>
<section id="plugin-projects" class="level2">
<h2>Plugin Projects</h2>
<p>If you want to <a href="../../native/plugin/submission.html">create/submit</a> a plugin for availability in the <a href="https://www.solar2dplugins.com/">Solar2D Plugins Marketplace</a>, you can use our <code>App</code> project templates to simplify development of your plugin, as well as test it. After all, a plugin itself is not an executable and it must be run inside an actual application. The project templates can be located within the Solar2D Native folder:</p>
<p><nobr><code>/Applications/Corona/Native/Project Template/App/</code></nobr></p>
<p>This folder has separate <nobr>platform-specific</nobr> subfolders for each target platform:</p>
<ul>
<li><code>ios</code></li>
<li><code>android</code></li>
</ul>
<p>There’s also a <code>Corona</code> folder that sits alongside these folders which contains a classic Corona project (<code>main.lua</code>). You can modify these files to test the Lua APIs that are offered by your plugin.</p>
<section id="ios" class="level3">
<h3>iOS</h3>
<p>In the <code>ios</code> folder, there are two Xcode projects:</p>
<ol type="1">
<li><p><code>App.xcodeproj</code> — This is the project that builds the <code>.app</code> executable which runs on the device. It automatically builds the plugin as an implicit dependency.</p></li>
<li><p><code>Plugin.xcodeproj</code> — For plugin development, you should modify this project. It builds the plugin as a static library (<code>.a</code>) and you can use this project directly if you want to share your plugin outside of the <code>App</code> project.</p></li>
</ol>
<div class="guide-notebox">
<div class="notebox-title">
Note
</div>
<p>Most often, you will want to create a <strong>universal binary</strong> for your plugin. In other words, you’d like to ship one static library that supports both the device and the <nobr>Xcode iOS Simulator</nobr>.</p>
<p>You can accomplish this via the <code>lipo</code> tool. In the following example, we are creating a universal library for <code>staticlibrary.a</code>:</p>
<pre class="brush: lua;">lipo -create "/path/to/iphoneos/staticlibrary.a" "/path/to/iphoneos-simulator/staticlibrary.a" -output "/path/to/dst/staticlibrary.a"</pre>
</div>
</section>
<section id="android" class="level3">
<h3>Android</h3>
<p>In the <code>android</code> folder, the contents include:</p>
<ol type="1">
<li><p><code>app</code> — This module builds the <code>.apk</code> that installs on the device. The <code>app</code> module automatically builds the plugin as an explicit dependency per this entry in the <code>dependencies</code> block of the <code>build.gradle</code> script for the <code>app</code> module (<code>compile project(':plugin')</code>).</p></li>
<li><p><code>plugin</code> — This module builds the plugin as a <code>.jar</code> file, only including the Java files under <code>plugin/src/main/java</code> in your project. You can use this project directly if you want to share your plugin outside of the <code>App</code> project.</p></li>
</ol>
<p><a id="coding"></a></p>
</section>
</section>
<section id="coding-plugins" class="level2">
<h2>Coding Plugins</h2>
<p>Plugins build upon Lua’s module system, so they can come in three different flavors:</p>
<ol type="1">
<li>Pure Lua code</li>
<li>Native code</li>
<li>Hybrid of Lua and native code</li>
</ol>
<section id="pure-lua" class="level3">
<h3>Pure Lua</h3>
<p>A Lua library plugin can be created using the <a href="../../api/type/CoronaLibrary/index.html">CoronaLibrary</a> class. Please see the <a href="../../native/plugin/luaplugin.html">Creating Lua Plugins</a> guide for details on how to create, package, and submit a Lua plugin to the available marketplaces.</p>
</section>
<section id="native-c" class="level3">
<h3>Native C</h3>
<p>In addition to the plugin naming conventions discussed above, Solar2D expects plugins to follow some additional conventions that ensure Lua can locate these modules. In C, these conventions are just the standard Lua naming conventions for modules:</p>
<ul>
<li>The name of the module function must be prefixed by <code>luaopen_</code>.</li>
<li>The signature of this function should match <a href="https://www.lua.org/manual/5.1/manual.html#lua_CFunction">lua_CFunction</a>.</li>
<li>If a module contains a dot (<code>.</code>), it is replaced by an underscore (<code>_</code>) in the name of the function, since C does not allow dots in symbol names.</li>
<li>This function should be publicly visible.</li>
</ul>
<p>For example, the Lua library <code>plugin.myLibrary</code> would have a Lua function called <code>luaopen_plugin_myLibrary</code>:</p>
<pre class="brush: lua; c">static int doSomething( lua_State *L )
{
    lua_getglobal( L, "print" );
    lua_pushstring( "I did something!" );
    CoronaLuaDoCall( L, 1, 0 );
    return 0;
}

// Export so it's visible to "require()"
CORONA_EXPORT
int luaopen_plugin_myLibrary( lua_State *L )
{
    static const luaL_Reg kFunctions[] =
    {
        { "doSomething", doSomething },

        { NULL, NULL }
    };

    // Create "myLibrary"
    // Lua version assumes version and revision default to 1
    int result = CoronaLibraryNew(
        L, "myLibrary", "com.mycompany", 1, 1, kFunctions, NULL );

    return result;
}</pre>
</section>
<section id="native-java" class="level3">
<h3>Native Java</h3>
<p>If you write the module in Java, Corona has set up Lua to load Java code and to let that Java code define the Lua library via <a href="https://code.google.com/archive/p/jnlua/">JNLua</a>. Here, Lua looks for the Java class <code>LuaLoader</code> and instantiates it.</p>
<p>Solar2D assumes the following conventions:</p>
<ul>
<li>The <code>LuaLoader</code> class has a default (empty) constructor.</li>
<li>The <code>LuaLoader</code> class must implement the JNLua interface <code>com.naef.jnlua.JavaFunction</code>.</li>
<li>The namespace of <code>LuaLoader</code> should be the same as the name passed to <code>require()</code>.</li>
</ul>
<p>For example, the Lua library <code>plugin.myLibrary</code> would be implemented by the <nobr>(fully-qualified)</nobr> class <code>plugin.myLibrary.LuaLoader</code> and that class would implement the <code>invoke()</code> method of the <code>com.naef.jnlua.JavaFunction</code> interface.</p>
</section>
<section id="lua-native" class="level3">
<h3>Lua + Native</h3>
<p>You can also create plugins in a hybrid fashion. For example, you can create the library via Lua code and then do further initialization in C.</p>
<p>Below is an example for creating the <code>myLibrary</code> library from Lua and then adding additional functions on the native C side. Here, we assume <code>kBuffer</code> stores the Lua bytecodes corresponding to <code>myLibrary.lua</code>.</p>
<pre class="brush: lua; c">// The bytecodes for "myLibrary.lua" are contained in kBuffer
static const unsigned char kBuffer[] = { ... }

static int bufferLoader( lua_State *L )
{
    return luaL_loadbuffer( L, (const char*)kBuffer, sizeof( kBuffer ), "myLibrary" );
}

static int somethingElse( lua_State *L )
{
    printf( "I'm doing something else!" );
    return 0;
}

CORONA_EXPORT
int luaopen_myLibrary( lua_State *L )
{
    lua_CFunction factory = Corona::Lua::Open&lt; bufferLoader >;
    int result = CoronaLibraryNewWithFactory( L, factory, NULL, NULL );

    if ( result )
    {
        const luaL_Reg kFunctions[] =
        {
            { "somethingElse", somethingElse },

            { NULL, NULL }
        };

        luaL_register( L, NULL, kFunctions );
    }

    return result;
}</pre>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
