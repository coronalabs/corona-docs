<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Plugins | appsflyer | logPurchase</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../css/style.css" />
  <link rel="stylesheet" href="../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../guide/index.html">Guides</a></li>
<li><a href="../../api/index.html">API Reference</a></li>
<li><a href="../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../plugin/index.html">Plugins</a></li>
<li><a href="../../native/index.html">Solar2D Native</a></li>
<li><a href="../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#appsflyer.logpurchase">appsflyer.logPurchase()</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#syntax">Syntax</a><ul>
<li><a href="#productdata-required">productData <sub><sup>(required)</sup></sub></a></li>
</ul></li>
<li><a href="#parameter-reference">Parameter Reference</a><ul>
<li><a href="#productid-required">productId <sub><sup>(required)</sup></sub></a></li>
<li><a href="#currency-required">currency <sub><sup>(required)</sup></sub></a></li>
<li><a href="#transactionid-required">transactionId <sub><sup>(required)</sup></sub></a></li>
<li><a href="#price-required">price <sub><sup>(required)</sup></sub></a></li>
<li><a href="#parameters-optional">parameters <sub><sup>(optional)</sup></sub></a></li>
<li><a href="#publickey-required">publicKey <sub><sup>(required)</sup></sub></a></li>
<li><a href="#signature-required">signature <sub><sup>(required)</sup></sub></a></li>
<li><a href="#purchasedata-required">purchaseData <sub><sup>(required)</sup></sub></a></li>
<li><a href="#price-required-1">price <sub><sup>(required)</sup></sub></a></li>
<li><a href="#currency-required-1">currency <sub><sup>(required)</sup></sub></a></li>
<li><a href="#parameters-optional-1">parameters <sub><sup>(optional)</sup></sub></a></li>
</ul></li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#ios">iOS</a></li>
<li><a href="#android">Android</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../plugin/index.html">Plugins</a>  ▸  <a href="../../plugin/appsflyer/index.html">appsflyer</a>  ▸  <a href="../../plugin/appsflyer/logPurchase.html">logPurchase</a>
</div>
<section id="appsflyer.logpurchase" class="level1">
<h1>appsflyer.logPurchase()</h1>
<blockquote>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Type</strong></td>
<td style="text-align: left;"><a href="../../api/type/Function.html">Function</a></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Return value</strong></td>
<td style="text-align: left;">none</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Revision</strong></td>
<td style="text-align: left;"><a href="https://solar2d.com/download/">Release 2024.3703</a></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Keywords</strong></td>
<td style="text-align: left;">analytics, attribution, AppsFlyer, logPurchase</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>See also</strong></td>
<td style="text-align: left;"><a href="../../plugin/appsflyer/getVersion.html">appsflyer.getVersion()</a></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><a href="../../plugin/appsflyer/index.html">appsflyer.*</a></td>
</tr>
</tbody>
</table>
</blockquote>
<section id="overview" class="level2">
<h2>Overview</h2>
<p>AppsFlyer’s SDK provides server verification for in-app purchases. This method automatically generates an <code>af_purchase</code> in-app event.</p>
<div class="guide-notebox-imp">
<div class="notebox-title-imp">
Important
</div>
<p>For a list of possible return values for validating receipts, please refer to Apple’s documentation <a href="https://developer.apple.com/library/content/releasenotes/General/ValidateAppStoreReceipt/Chapters/ValidateRemotely.html">here</a>.</p>
</div>
</section>
<section id="syntax" class="level2">
<h2>Syntax</h2>
<pre class="brush: lua;">appsflyer.logPurchase( productData )</pre>
<section id="productdata-required" class="level5">
<h5>productData <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/Table.html">Table</a>.</em> Table containing key-value parameters. In-App Events provide insights on what is happening in your app. It is recommended to take the time and define the events you want to measure to allow you to track ROI (Return on Investment) and LTV (Lifetime Value).</p>
<p>You may specify your own custom key-value parameters (optional). Values should be of type <code>String</code>.</p>
</section>
</section>
<section id="parameter-reference" class="level2">
<h2>Parameter Reference</h2>
<p>The <code>productData</code> table for iOS includes following parameters for logging IAP purchases:</p>
<section id="productid-required" class="level5">
<h5>productId <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> The product ID/name for the IAP purchase.</p>
</section>
<section id="currency-required" class="level5">
<h5>currency <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> The currency of the IAP transaction.</p>
</section>
<section id="transactionid-required" class="level5">
<h5>transactionId <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> The transaction ID. This parameter applies to Apple App Store transactions only and is mandatory when logging an Apple IAP receipt. It expects the data from event.transaction.identifier found in the in-app purchase transaction callback.</p>
</section>
<section id="price-required" class="level5">
<h5>price <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> The unit price of the IAP item. The <code>price</code> parameter should contain the total revenue associated to the validated purchase event.</p>
</section>
<section id="parameters-optional" class="level5">
<h5>parameters <sub><sup>(optional)</sup></sub></h5>
<p><em><a href="../../api/type/Table.html">Table</a>.</em> Table containing additional key-value parameters.</p>
<div style="margin-top: 16px;">

</div>
<p>The <code>productData</code> table for Android includes following parameters for logging IAP purchases:</p>
</section>
<section id="publickey-required" class="level5">
<h5>publicKey <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> API Key, the developer gets this from the Google portal.</p>
</section>
<section id="signature-required" class="level5">
<h5>signature <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> The transaction signature. The developer gets it from google api when purchase succeeded. This parameter applies to Google Play transactions only and is mandatory when logging a Google IAP receipt. It expects the data from event.transaction.signature found in the in-app purchase transaction callback.</p>
</section>
<section id="purchasedata-required" class="level5">
<h5>purchaseData <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> Purchase data is the actual product purchased in json format. The developer gets it from google api when purchase succeeded.</p>
</section>
<section id="price-required-1" class="level5">
<h5>price <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> The unit price of the IAP item. The <code>price</code> parameter should contain the total revenue associated to the validated purchase event.</p>
</section>
<section id="currency-required-1" class="level5">
<h5>currency <sub><sup>(required)</sup></sub></h5>
<p><em><a href="../../api/type/String.html">String</a>.</em> The currency of the IAP transaction.</p>
</section>
<section id="parameters-optional-1" class="level5">
<h5>parameters <sub><sup>(optional)</sup></sub></h5>
<p><em><a href="../../api/type/Table.html">Table</a>.</em> Table containing additional key-value parameters.</p>
</section>
</section>
<section id="examples" class="level2">
<h2>Examples</h2>
<section id="ios" class="level5">
<h5>iOS</h5>
<pre class="brush: lua;">local appsflyer = require( "plugin.appsflyer" )

local function appsflyerListener( event )
    -- Handle events here
end

-- Initialize plugin
appsflyer.init( appsflyerListener,
    {
        appID = "YOUR_APP_ID",
       devKey = "YOUR_DEV_KEY"
    }
)

appsflyer.logPurchase(
    {
       productId = "111",
       price = "100",
       currency = "USD",
       transactionId = "222",
       parameters = { first = "1", second = "2" }
    }
)</pre>
</section>
<section id="android" class="level5">
<h5>Android</h5>
<pre class="brush: lua;">local appsflyer = require( "plugin.appsflyer" )

local function appsflyerListener( event )
   -- Handle events here
end

-- Initialize plugin
appsflyer.init( appsflyerListener,
    {
       appID = "YOUR_APP_ID",
       devKey = "YOUR_DEV_KEY"
    }
)

appsflyer.logPurchase(
    {
       publicKey = "111",
       signature = "222",
       purchaseData = "333",
       price = "100",
       currency = "USD",
       parameters = { first = "1", second = "2" }
    }
)</pre>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
