<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Tutorials | Gaming/Physics</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../../css/style.css" />
  <link rel="stylesheet" href="../../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="../../../api/index.html">API Reference</a></li>
<li><a href="../../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../native/index.html">Solar2D Native</a></li>
<li><a href="../../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#basic-object-spawning">Basic Object Spawning</a><ul>
<li><a href="#initial-setup">Initial Setup</a></li>
<li><a href="#spawn-parameters">Spawn Parameters</a></li>
<li><a href="#basic-spawning-function">Basic Spawning Function</a></li>
<li><a href="#spawn-controller">Spawn Controller</a></li>
<li><a href="#calling-the-spawn-controller">Calling the Spawn Controller</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../../tutorial/index.html">Tutorials</a>  ▸  <a href="../../../tutorial/games/index.html">Gaming/Physics</a>
</div>
<section id="basic-object-spawning" class="level1">
<h1>Basic Object Spawning</h1>
<p>In game design, a common element is <strong>object spawning</strong>, whether it be spawning a variable number of enemies and placing them randomly about the screen, or spawning items repeatedly on a timer increment. In this tutorial, we’ll step through a basic spawning module which includes the following features:</p>
<ul>
<li>Set rectangular bounds on the screen within which to spawn objects.</li>
<li>Spawn an initial number of objects immediately (optional).</li>
<li>Spawn a flexible amount of objects on a repeating timer.</li>
<li>Pause, resume, or stop the spawning process.</li>
</ul>
<section id="initial-setup" class="level2">
<h2>Initial Setup</h2>
<p>Let’s begin with a few initial commands…</p>
<pre class="brush: lua;">local spawnTimer
local spawnedObjects = {}

-- Seed the random number generator
math.randomseed( os.time() )</pre>
<p>The first variable, <code>spawnTimer</code>, is simply a Lua forward reference to the timer object which we’ll use to control the spawning process. The second variable, <code>spawnedObjects</code>, is a basic table into which we’ll insert items as they are spawned, providing us with a basic method to track them, count them, loop over them, etc.</p>
<p>The third command sets the “seed” for the <nobr>pseudo-random</nobr> number generator. On some operating systems, this generator begins with the same initial value which causes random numbers to repeat in a predictable pattern. This addition to our code ensures that the generator always starts with a different seed.</p>
</section>
<section id="spawn-parameters" class="level2">
<h2>Spawn Parameters</h2>
<p>Now, let’s set up a table of basic spawning parameters which we can use to adjust/control the spawning:</p>
<pre class="brush: lua;">local spawnParams = {
    xMin = 20,
    xMax = 300,
    yMin = 20,
    yMax = 460,
    spawnTime = 200,
    spawnOnTimer = 12,
    spawnInitial = 4
}</pre>
<p>All of these parameters are optional and will default to various values (details later) but they should usually be set to appropriate values for your game. Essentially, the first four parameters define the rectangular region on the screen in which items will spawn, as defined by a minimum and maximum for both <strong>x</strong> and <strong>y</strong>. The next parameter (<code>spawnTime</code>) defines the timed increment, in milliseconds, upon which new items will spawn, assuming an amount of items is defined by the <code>spawnOnTimer</code> parameter. Lastly, the <code>spawnInitial</code> parameter can be used to instantly spawn a certain number of items, if the game design calls for it.</p>
</section>
<section id="basic-spawning-function" class="level2">
<h2>Basic Spawning Function</h2>
<p>Next, we’ll need a basic spawning function which creates the objects:</p>
<pre class="brush: lua;">-- Spawn an item
local function spawnItem( bounds )

    -- Create an item
    local item = display.newCircle( 0, 0, 20 )

    -- Position item randomly within set bounds
    item.x = math.random( bounds.xMin, bounds.xMax )
    item.y = math.random( bounds.yMin, bounds.yMax )

    -- Add item to "spawnedObjects" table for tracking purposes
    spawnedObjects[#spawnedObjects+1] = item
end</pre>
<p>The first few lines create a sample item — in this case a basic white vector circle. Obviously these items could be images, animated sprites, objects which you then enable for physics usage, etc.</p>
<p>The next few lines position the item randomly within the declared bounds. Recall that we declared these as the first four parameters in the <code>spawnParams</code> table.</p>
<p>The final line simply adds the new item to the <code>spawnedObjects</code> table, providing a simple method to track and manage the spawned objects.</p>
</section>
<section id="spawn-controller" class="level2">
<h2>Spawn Controller</h2>
<p>The next step is to create a simple but reasonably powerful “controller” function which allows us to start, stop, pause, and resume the spawning process. This function will accept two arguments: an <code>action</code> argument which represents the action to perform and a <code>params</code> argument (this represents the <code>spawnParams</code> table that we declared above).</p>
<pre class="first-line: 1; gutter: true; brush: lua;">local function spawnController( action, params )

    -- Cancel timer on "start" or "stop", if it exists
    if ( spawnTimer and ( action == "start" or action == "stop" ) ) then
        timer.cancel( spawnTimer )
    end

    -- Start spawning
    if ( action == "start" ) then

        -- Gather/set spawning bounds
        local spawnBounds = {}
        spawnBounds.xMin = params.xMin or 0
        spawnBounds.xMax = params.xMax or display.contentWidth
        spawnBounds.yMin = params.yMin or 0
        spawnBounds.yMax = params.yMax or display.contentHeight

        -- Gather/set other spawning params
        local spawnTime = params.spawnTime or 1000
        local spawnOnTimer = params.spawnOnTimer or 50
        local spawnInitial = params.spawnInitial or 0

        -- If "spawnInitial" is greater than 0, spawn that many item(s) instantly
        if ( spawnInitial > 0 ) then
            for n = 1,spawnInitial do
                spawnItem( spawnBounds )
            end
        end

        -- Start repeating timer to spawn items
        if ( spawnOnTimer > 0 ) then
            spawnTimer = timer.performWithDelay( spawnTime,
                function() spawnItem( spawnBounds ); end,
            spawnOnTimer )
        end

    -- Pause spawning
    elseif ( action == "pause" ) then
        timer.pause( spawnTimer )

    -- Resume spawning
    elseif ( action == "resume" ) then
        timer.resume( spawnTimer )
    end
end</pre>
<p>Let’s examine this function <nobr>step-by-step</nobr>:</p>
<ul>
<li>On lines 4-6, we include a few lines to cancel the timer on the start and stop actions. Recall that we <nobr>forward-referenced</nobr> the timer object (<code>spawnTimer</code>) at the start, so we can safely use that reference here.</li>
</ul>
<div class="code-indent">
<pre class="highlight: [4,5,6]; first-line: 3; gutter: true; brush: lua;">-- Cancel timer on "start" or "stop", if it exists
if ( spawnTimer and ( action == "start" or action == "stop" ) ) then
    timer.cancel( spawnTimer )
end</pre>
<div class="docs-tip-outer">
<div class="docs-tip-inner-left">
<div class="fa fa-cog">

</div>
</div>
<div class="docs-tip-inner-right">
<p>It’s fairly obvious why we cancel the timer on the <strong>stop</strong> action, but why do we also cancel it on the <strong>start</strong> action? Basically, it’s just a <nobr>fail-safe</nobr>, so if the function is called multiple times with the start action, the previous timer object is cancelled and it can begin in a clean state.</p>
</div>
</div>
</div>
<ul>
<li>In the next block, we handle the most important spawning action: the <strong>start</strong> action.</li>
</ul>
<div class="code-indent">
<p>In the initial lines of this conditional block, we gather/set various parameters based on those defined in the <code>spawnParams</code> table which was declared earlier. As noted, all of those parameters are optional, so if any are undefined, we set some basic defaults in their place.</p>
<pre class="highlight: [11,12,13,14,15,16,17,18,19,20,21]; first-line: 8; gutter: true; brush: lua;">-- Start spawning
if ( action == "start" ) then

    -- Gather/set spawning bounds
    local spawnBounds = {}
    spawnBounds.xMin = params.xMin or 0
    spawnBounds.xMax = params.xMax or display.contentWidth
    spawnBounds.yMin = params.yMin or 0
    spawnBounds.yMax = params.yMax or display.contentHeight

    -- Gather/set other spawning params
    local spawnTime = params.spawnTime or 1000
    local spawnOnTimer = params.spawnOnTimer or 50
    local spawnInitial = params.spawnInitial or 0</pre>
<p>Next, we check if the <code>spawnInitial</code> parameter is greater than <code>0</code> and, if so, we instantly spawn that number of items. Note that we pass the <code>spawnBounds</code> table to the <code>spawnItem()</code> function so it recognizes the limits in which to spawn the items.</p>
<pre class="highlight: [23,24,25,26,27,28]; first-line: 8; gutter: true; brush: lua;">-- Start spawning
if ( action == "start" ) then

    -- Gather/set spawning bounds
    local spawnBounds = {}
    spawnBounds.xMin = params.xMin or 0
    spawnBounds.xMax = params.xMax or display.contentWidth
    spawnBounds.yMin = params.yMin or 0
    spawnBounds.yMax = params.yMax or display.contentHeight

    -- Gather/set other spawning params
    local spawnTime = params.spawnTime or 1000
    local spawnOnTimer = params.spawnOnTimer or 50
    local spawnInitial = params.spawnInitial or 0

    -- If "spawnInitial" is greater than 0, spawn that many item(s) instantly
    if ( spawnInitial > 0 ) then
        for n = 1,spawnInitial do
            spawnItem( spawnBounds )
        end
    end</pre>
<p>Following this, we check if the <code>spawnOnTimer</code> parameter is greater than <code>0</code> and, if so, we start a timer which spawns that amount of items on the set <code>spawnTime</code> increment. Note that we set this timer object to the <code>spawnTimer</code> reference so we can pause, resume, or stop it later if needed. As above, we pass the <code>spawnBounds</code> table to the anonymous function so that all items are spawned within the desired bounds.</p>
<pre class="highlight: [30,31,32,33,34,35]; first-line: 8; gutter: true; brush: lua;">-- Start spawning
if ( action == "start" ) then

    -- Gather/set spawning bounds
    local spawnBounds = {}
    spawnBounds.xMin = params.xMin or 0
    spawnBounds.xMax = params.xMax or display.contentWidth
    spawnBounds.yMin = params.yMin or 0
    spawnBounds.yMax = params.yMax or display.contentHeight

    -- Gather/set other spawning params
    local spawnTime = params.spawnTime or 1000
    local spawnOnTimer = params.spawnOnTimer or 50
    local spawnInitial = params.spawnInitial or 0

    -- If "spawnInitial" is greater than 0, spawn that many item(s) instantly
    if ( spawnInitial > 0 ) then
        for n = 1,spawnInitial do
            spawnItem( spawnBounds )
        end
    end

    -- Start repeating timer to spawn items
    if ( spawnOnTimer > 0 ) then
        spawnTimer = timer.performWithDelay( spawnTime,
            function() spawnItem( spawnBounds ); end,
        spawnOnTimer )
    end</pre>
</div>
<ul>
<li>The final step is to account for the <strong>pause</strong> and <strong>resume</strong> actions. This is simply accomplished by adding two more conditional code blocks and calling the necessary timer API:</li>
</ul>
<div class="code-indent">
<pre class="highlight: [37,38,39,41,42,43]; first-line: 37; gutter: true; brush: lua;">    -- Pause spawning
    elseif ( action == "pause" ) then
        timer.pause( spawnTimer )

    -- Resume spawning
    elseif ( action == "resume" ) then
        timer.resume( spawnTimer )
    end
end</pre>
</div>
</section>
<section id="calling-the-spawn-controller" class="level2">
<h2>Calling the Spawn Controller</h2>
<p>From this point, the spawn controller can easily be called with four possible actions. Note that calling the <code>spawnController()</code> function with <code>"start"</code> as the <code>action</code> parameter is the sole use case which requires the <code>spawnParams</code> table — the other actions assume that the spawning process is already underway.</p>
<pre class="brush: lua;">spawnController( "start", spawnParams )</pre>
<pre class="brush: lua;">spawnController( "pause" )</pre>
<pre class="brush: lua;">spawnController( "resume" )</pre>
<pre class="brush: lua;">spawnController( "stop" )</pre>
</section>
<section id="conclusion" class="level2">
<h2>Conclusion</h2>
<p>Hopefully this tutorial gives you a simple base module atop which to build a more comprehensive spawning methodology involving animated sprites, physics objects, variable time increments, and much more.</p>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
