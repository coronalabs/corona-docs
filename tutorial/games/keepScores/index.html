<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Cousine&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" type="image/ico" href="/images/favicon.ico" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Solar2D Documentation — Tutorials | Gaming/Physics</title>
  <meta name="description" content="Solar2D lets you build games/apps for all major platforms including iOS, Android, Kindle, Apple TV, Android TV, macOS, and Windows. Get the free toolset!" />
  <link rel="stylesheet" href="../../../css/style.css" />
  <link rel="stylesheet" href="../../../css/shCoreDefault.css" />
<script src="https://corona-cdn.coronalabs.com/js/docs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-14', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="header"></div>
<div class="title">
	<span class="titleimg" onclick="window.location='https://docs.coronalabs.com/'"></span>
	<div id="nav">
		<ul>
<li><a href="../../../guide/programming/index.html">Getting Started</a></li>
<li><a href="../../../guide/index.html">Guides</a></li>
<li><a href="../../../api/index.html">API Reference</a></li>
<li><a href="../../../tutorial/index.html">Tutorials</a></li>
<li><a href="../../../plugin/index.html">Plugins</a></li>
<li><a href="../../../native/index.html">Solar2D Native</a></li>
<li><a href="../../../coronacards/index.html">CoronaCards</a></li>
</ul>

		<!--
		<div id="resources-link"><a href="https://coronalabs.com/resources/">Corona Resources</a></div>
		-->
	</div>
</div>

<div class="SearchBar">
  <form action="https://www.google.com/cse" id="cse-search-box">
  <input type="hidden" name="cx" value="009283852522218786394:g40gqt2m6rq" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" placeholder="Search" name="q" id="q" autocomplete="off" size="40" />
  <input type="submit" name="sa" value="Search" />
  </form>
</div>
<div id="TOC">
<ul>
<li><a href="#displaying-and-saving-scores">Displaying and Saving Scores</a><ul>
<li><a href="#the-score-module">The Score Module</a></li>
<li><a href="#set-get-and-add-functions">Set, Get, and Add Functions</a></li>
<li><a href="#saving-and-loading-the-score">Saving and Loading the Score</a></li>
<li><a href="#using-the-module">Using the Module</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul></li>
</ul>
</div>
<div id="breadcrumb">
<a href="https://docs.coronalabs.com">Documentation</a>  ▸  <a href="../../../tutorial/index.html">Tutorials</a>  ▸  <a href="../../../tutorial/games/index.html">Gaming/Physics</a>
</div>
<section id="displaying-and-saving-scores" class="level1">
<h1>Displaying and Saving Scores</h1>
<p>A frequently asked question from game developers new to Corona/Lua is <nobr>“How do I keep score?”</nobr> This tutorial will walk you through the entire process, including:</p>
<ol type="1">
<li>Setting up a variable to hold the score.</li>
<li>Displaying the score.</li>
<li>Saving (and retrieving) the score for future use.</li>
</ol>
<section id="the-score-module" class="level2">
<h2>The Score Module</h2>
<p>Corona does not have a <nobr>built-in</nobr> “score” module, so let’s build one which you can implement in your apps, beginning with a basic initialization function.</p>
<p>To begin, create a new empty Lua file within your project directory. Name this file <code>score.lua</code>. Open the file in your text editor and insert the following code:</p>
<pre class="first-line: 1; gutter: true; brush: lua;">local M = {}

M.score = 0  -- Set the score to 0 initially

function M.init( options )

    local customOptions = options or {}
    local opt = {}
    opt.fontSize = customOptions.fontSize or 24
    opt.font = customOptions.font or native.systemFont
    opt.x = customOptions.x or display.contentCenterX
    opt.y = customOptions.y or opt.fontSize*0.5
    opt.maxDigits = customOptions.maxDigits or 6
    opt.leadingZeros = customOptions.leadingZeros or false

    local prefix = ""
    if ( opt.leadingZeros ) then 
        prefix = "0"
    end
    M.format = "%" .. prefix .. opt.maxDigits .. "d"

    -- Create the score display object
    M.scoreText = display.newText( string.format( M.format, 0 ), opt.x, opt.y, opt.font, opt.fontSize )

    return M.scoreText
end

return M</pre>
<p>Here, we first set up a basic module <nobr>table <code>M</code> —</nobr> this table will contain all of the functions we create so that they can be called from whatever module includes this module. Following that, we set a <code>score</code> property for the <code>M</code> table and initially set it to <code>0</code>. For the <code>init()</code> function, we accept one parameter, <code>options</code>, which is a Lua table of <nobr>key-value</nobr> pairs. The supported options include:</p>
<ul>
<li><code>fontSize</code> — The size of the displayed score text.</li>
<li><code>font</code> — The font used for the displayed score text. See the <a href="../../../guide/system/customFont/index.html">Using Custom Fonts</a> guide for details on using custom fonts within a Corona app.</li>
<li><code>x</code> — The <strong>x</strong> location to draw the score display.</li>
<li><code>y</code> — The <strong>y</strong> location to draw the score display.</li>
<li><code>maxDigits</code> — The estimated maximum number of digits for the score.</li>
<li><code>leadingZeros</code> — <code>true</code> or <code>false</code> depending on whether you want leading zeros.</li>
</ul>
<p>If any of the supported options are <strong>not</strong> specified, we fall back to reasonable defaults, in this case the default system font at 24 point size, centered at the top of the screen, with a maximum of 6 digits.</p>
<div class="guide-notebox">
<div class="notebox-title">
Notes
</div>
<ul>
<li><p>We could extend this with alignment properties and other settings. For example, we could add options to control the anchor point for <nobr>left-aligned</nobr> or <nobr>right-aligned</nobr> score text.</p></li>
<li><p>The score text uses the <code>string.format()</code> API to format the number. Here, the string will either be prefixed by spaces or by zeros, depending on the settings. This format setting is also saved to the module (<code>M.format</code>) for usage in other functions. For more details on string formatting, please see the <a href="../../../tutorial/data/formattingStrings/index.html">Formatting String Values</a> tutorial.</p></li>
</ul>
</div>
</section>
<section id="set-get-and-add-functions" class="level2">
<h2>Set, Get, and Add Functions</h2>
<p>Next, let’s include some functions for <strong>setting</strong>, <strong>getting</strong>, and <strong>adding</strong> to the score:</p>
<pre class="highlight: [28,29,30,31,32,34,35,36,37,39,40,41,42,43]; first-line: 28; gutter: true; brush: lua;">function M.set( value )

    M.score = tonumber(value)
    M.scoreText.text = string.format( M.format, M.score )
end

function M.get()

    return M.score
end

function M.add( amount )

    M.score = M.score + tonumber(amount)
    M.scoreText.text = string.format( M.format, M.score )
end

return M</pre>
<p>Let’s quickly inspect these three new functions:</p>
<ul>
<li><p>If we call the <code>set()</code> function, the score display object (<code>M.scoreText</code>) will visibly update to the new value.</p></li>
<li><p>The <code>get()</code> method simply returns the current score for some other use.</p></li>
<li><p>The <code>add()</code> function allows us to add a value to the current score and update the display object. While this concept could be extended to an additional “subtract” function, it would be more efficient to just pass a negative value as <code>amount</code>.</p></li>
</ul>
</section>
<section id="saving-and-loading-the-score" class="level2">
<h2>Saving and Loading the Score</h2>
<p>The last thing our module needs is the ability to save and load the score. This is essential functionality if the score must be saved as a high score, in which case it must persist between app sessions:</p>
<pre class="highlight: [45,46,47,48,49,50,51,53,54,55,56,57,58,59,60,61,62]; first-line: 45; gutter: true; brush: lua;">function M.save()

    local saved = system.setPreferences( "app", { currentScore=M.score } )
    if ( saved == false ) then
        print( "ERROR: could not save score" )
    end
end

function M.load()

    local score = system.getPreference( "app", "currentScore", "number" )

    if ( score ) then
        return tonumber(score)
    else
        print( "ERROR: could not load score (score may not exist in storage)" )
    end
end

return M</pre>
<p>Both of these functions are relatively straightforward:</p>
<ul>
<li><p>The <code>save()</code> function saves the current score (<code>M.score</code>) to the app’s local storage under the key <code>currentScore</code>. If the process fails, it outputs an error message to the console.</p></li>
<li><p>The <code>load()</code> function loads the associated key from the app’s local storage and sets it to the variable <code>score</code>. If the process succeeds, it returns that value, otherwise it outputs an error message to the console.</p></li>
</ul>
</section>
<section id="using-the-module" class="level2">
<h2>Using the Module</h2>
<p>With our <code>score.lua</code> module created and the basic functions written, we can now use it within our app. In another scene or Lua module, for instance, the score module can be implemented like this:</p>
<pre class="brush: lua;">local score = require( "score" )

local scoreText = score.init(
{
    fontSize = 20,
    font = "CoolCustomFont.ttf",
    x = display.contentCenterX,
    y = 30,
    maxDigits = 7,
    leadingZeros = true
})</pre>
<p>The first line is the mandatory <code>require()</code> line which includes the <code>score.lua</code> module in the project, providing access to all of the functions we wrote above. The second block calls the module’s <code>init()</code> function with a series of basic parameters. This creates the text display, centers it near the top of the screen, and sets it to a <nobr>zero-filled</nobr> <nobr>7-digit</nobr> score.</p>
<p>From this point, the following actions can be executed with just one line:</p>
<div class="inner-table">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Command</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>score.set( value )</code></td>
<td style="text-align: left;">Sets the score to <code>value</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><nobr><code>local currentScore = score.get()</code></nobr></td>
<td style="text-align: left;">Gets the current score.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>score.add( value )</code></td>
<td style="text-align: left;"><nobr>Adds <code>value</code> to the current score.  </nobr></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>score.save()</code></td>
<td style="text-align: left;">Saves the score to local storage.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>local savedScore = score.load()</code></td>
<td style="text-align: left;">Loads the previously-saved score.</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="conclusion" class="level2">
<h2>Conclusion</h2>
<p>Hopefully this tutorial illustrates just how easy it is to work with scores in Corona, including saving and loading scores to the device for persistence between app sessions.</p>
<hr>
<div id="footer">
<p class="copyright">
© 2020-2024 Solar2D All Rights Reserved.
</p>
<p class="feedback">
Help us help you! If you notice a problem with this page, please report it.
</p>
<p><a class="feedback-button" href="https://github.com/coronalabs/corona-docs/issues" target="_blank">Report an Issue</a></p>
</div>
</section>
</section>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shCore.js" type="text/javascript"></script>
<script src="https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
    // Define syntax highlighting scripts.
    // N.B.: As a safeguard, you will need to whitelist the brush in filter-SyntaxHighlighter.py

    SyntaxHighlighter.autoloader(
      ['c#','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushCSharp.js'],
      ['java','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJava.js'],
      ['js','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushJScript.js'],
      ['lua','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushLua.js'],
      ['php','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushPhp.js'],
      ['sql','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushSql.js'],
      ['xml','https://corona-cdn.coronalabs.com/js/SyntaxHighlighter/shBrushXml.js']
    );

    // Set default configurations.
    SyntaxHighlighter.defaults['gutter'] = false; // Disable line numbers.
    SyntaxHighlighter.defaults['toolbar'] = false; // Disable link back to author's site. :(
	SyntaxHighlighter.defaults['quick-code'] = false; // Disable double click feature

    // Perform the highlighting.
    SyntaxHighlighter.all();
</script>
</body>
</html>
